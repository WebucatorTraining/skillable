<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
	<title>Module 7: Labs</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="stylesheet.css" />
</head>
<body class="calibre">
	<p id="id_Toc144885890" class="block_14">Exercise 1 – Create a new PBIX project file</p>
	<p class="block_">We will start by creating and saving our PBIX project file to our computer, this will be used
		throughout the design of our data model and report to save our progress.</p>
	<ol class="list_">
		<li class="block_15">On your computer press the <b class="calibre6">Start</b> <img src="images/image-63.png"
				alt="Image" class="calibre86" /> key on your keyboard and type in <b class="calibre6">Power BI</b><br
				class="calibre2" /> </li>
		<li class="block_16">Click on <b class="calibre6">Power BI Desktop</b><br class="calibre2" /><br
				class="calibre2" /><img src="images/image-64.png" alt="Image" class="calibre87" /></li>
		<li class="block_16">The Power BI Desktop launcher will appear, use the <b class="calibre6">X</b> button to close this
			window<br class="calibre2" /><br class="calibre2" /><img src="images/image-65.png" alt="Image"
				class="calibre88" /><br class="calibre2" /> </li>
		<li class="block_16">In the ribbon, click on the <b class="calibre6">File</b> tab<br class="calibre2" /><br
				class="calibre2" /><img src="images/image-66.png" alt="Image" class="calibre89" /><br class="calibre2" /> </li>
		<li class="block_16">Next, click on <b class="calibre6">Save</b> in the left menu<br class="calibre2" /> </li>
		<li class="block_16">Using <i class="calibre7">File Explorer</i> choose a location to save your work, remember you
			will need it throughout the course so ensure it is somewhere that you will be able to find it again<br
				class="calibre2" /> </li>
		<li class="block_23">Name the file <b class="calibre6">House Rules Sales Analysis</b> then click <b
				class="calibre6">Save</b></li>
	</ol>
	<p id="id_Toc144885891" class="block_14">Exercise 2 – Connecting to data sources</p>
	<p class="block_">To build our report we require data, and our transactions database has been made available for us to
		connect to. In this exercise we will use a database, which is hosted in Azure SQL Server. To connect to this data, we
		will use the Get Data command and select Azure SQL database and use the information and account details that we have
		been provided with to form the connection.</p>
	<ol class="list_">
		<li class="block_15">In Power BI Desktop, click on the <b class="calibre6">Get Data</b> button in the <i
				class="calibre7">Home</i> tab of the ribbon (the top half of this button will open the full menu)<br
				class="calibre2" /><br class="calibre2" /><img src="images/image-67.png" alt="Image" class="calibre90" /><br
				class="calibre2" /> </li>
		<li class="block_16">From the categories on the left of the <i class="calibre7">Get Data </i>dialog box, select <b
				class="calibre6">Azure</b><br class="calibre2" /> </li>
		<li class="block_16">Next, from the available data sources on the right, choose <b class="calibre6">Azure SQL
				database</b><br class="calibre2" /><br class="calibre2" /><img src="images/image-68.png" alt="Image"
				class="calibre91" /><br class="calibre2" /> </li>
		<li class="block_16">Click <b class="calibre6">Connect</b><br class="calibre2" /> </li>
		<li class="block_16">In the <i class="calibre7">SQL Server database</i> dialog box enter the following:<br
				class="calibre2" /> </li>
	</ol>
	<ol class="list_1">
		<li class="block_22">Server: <b class="calibre6">spoclass.database.windows.net</b></li>
		<li class="block_22">Database: <b class="calibre6">ckpowerbi</b></li>
		<li class="block_22">Data Connectivity mode: <b class="calibre6">Import<br class="calibre2" /><br
					class="calibre2" /></b><img src="images/image-69.png" alt="Image" class="calibre92" /></li>
	</ol>
	<ol class="list_">
		<li value="6" class="block_16">Click <b class="calibre6">OK</b><br class="calibre2" /> </li>
		<li class="block_16"><span class="text_11">IMPORTANT</span><span class="text_10"> </span>on the <i
				class="calibre7">SQL Server database</i> dialog box, select <b class="calibre6">Database</b> from the navigation
			on the left<br class="calibre2" /><br class="calibre2" /><img src="images/image93.png" alt="Image"
				class="calibre93" /><br class="calibre2" /> </li>
		<li class="block_16">Then enter the following credentials:</li>
	</ol>
	<ol class="list_1">
		<li class="block_22">User name: <b class="calibre6">ckdatauser</b></li>
		<li class="block_22">Password: <b class="calibre6">Pa$$w0rd</b><br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li value="9" class="block_16">Then click <b class="calibre6">Connect</b><br class="calibre2" /> </li>
		<li class="block_16">In the <i class="calibre7">Navigator</i> dialog, select all 4 tables<br class="calibre2" /><br
				class="calibre2" /><img src="images/image-70.png" alt="Image" class="calibre94" /><br class="calibre2" /> </li>
		<li class="block_16">Next, click on <b class="calibre6">Load</b><br class="calibre2" /> </li>
		<li class="block_23">Allow a moment for the connection to load the data into your query, this may take longer on a
			slower internet connection, the <i class="calibre7">Fields</i> pane on the right will populate once finished<br
				class="calibre2" /><br class="calibre2" /><img src="images/image95.png" alt="Image" class="calibre95" /></li>
	</ol>
	<p id="id_Toc144885892" class="block_14">Exercise 3 – Use the Power Query editor</p>
	<p class="block_">Now that we have connected to our data source, we will start to review the data we have and whether we
		need to make some changes to it using a query. A query allows us to write a list of instructions for each table in our
		data model. We can rename and format columns plus we can enact a diverse series of changes to ensure the data is clean
		and ready for calculating. We will split this exercise into 4 separate queries as there are 4 tables.</p>
	<p id="id_Toc144885893" class="block_30">Open Power Query</p>
	<p class="block_">To get started we will need to open Power Query. This opens as a <i class="calibre7">separate
			window</i>. </p>
	<ol class="list_">
		<li class="block_15">In the <b class="calibre6">Home</b> tab of the ribbon, click on <b class="calibre6">Transform
				data</b> in the <i class="calibre7">Queries</i> category (note the button is split in two, click on the top half
			of the button to open Power Query Editor)<br class="calibre2" /><br class="calibre2" /><img
				src="images/image-71.png" alt="Image" class="calibre96" /><br class="calibre2" /> </li>
		<li class="block_16">The Power Query Editor will open, position this new window to suit you (you may also want to
			minimise Power BI Desktop to avoid confusing it for the Power Query Editor)<br class="calibre2" /><br
				class="calibre2" /><img src="images/image-72.png" alt="Image" class="calibre97" /><br class="calibre2" /> </li>
		<li class="block_24">Notice that the <i class="calibre7">Customer Records Sheet </i>is selected in the <i
				class="calibre7">Queries</i> pane on the left of the window, if it is not selected, please selected it<br
				class="calibre2" /><br class="calibre2" /><img src="images/image-73.png" alt="Image" class="calibre98" /></li>
	</ol>
	<p id="id_Toc144885894" class="block_30">Customer Records Query</p>
	<p class="block_">Our customer records are in a table that carries important information about the accounts that have
		been created to purchase our products. You will find names, addresses and more in here. Sadly, the information in the
		table is a bit messy, so we will get you to perform a variety of changes to overhaul this data.</p>
	<ol class="list_">
		<li class="block_15">As we update the query for our customer data, we may need the formula bar, to activate it, click
			on the <b class="calibre6">View</b> tab in the ribbon and ensure <b class="calibre6">Formula bar</b> is checked in
			the <i class="calibre7">Layout</i> category, once ready return to the <b class="calibre6">Home </b>tab<br
				class="calibre2" /><br class="calibre2" /><img src="images/image99.png" alt="Image" class="calibre99" /><br
				class="calibre2" /> </li>
		<li class="block_16">To remove any unnecessary columns from the Customers table, in the <b class="calibre6">Home</b><i
				class="calibre7"> </i>tab of the ribbon we can click on <b class="calibre6">Choose Columns</b><br
				class="calibre2" /><br class="calibre2" /><img src="images/image100.png" alt="Image" class="calibre100" /><br
				class="calibre2" /> </li>
	</ol>
	<table class="table_1">
		<tbody class="calibre46">
			<tr class="calibre47">
				<td class="td_10">
					<ol class="list_">
						<li value="3" class="block_32">In the <i class="calibre101">Choose Columns</i> menu, deselect the ticks
							against:<br class="calibre102" /> </li>
					</ol>
					<ol class="list_1">
						<li class="block_33">Company</li>
						<li class="block_33">EmailAddress</li>
						<li class="block_33">WorkPhone</li>
						<li class="block_33">HomePhone</li>
						<li class="block_33">Address</li>
						<li class="block_33">Website</li>
						<li class="block_33">Invoices Sheet</li>
					</ol>
					<p class="block_34"> </p>
				</td>
				<td class="td_11">
					<p class="block_28"><img src="images/image-74.png" alt="Image" class="calibre103" /></p>
				</td>
			</tr>
		</tbody>
	</table>
	<p class="block_29"> </p>
	<ol class="list_">
		<li value="4" class="block_16">Once you have the correct selection click <b class="calibre6">OK</b><br
				class="calibre2" /> </li>
		<li class="block_16">Next, you will bring together the first and last name of the customer by using a merging command,
			to do this select the <b class="calibre6">FirstName</b> column then hold down the <b class="calibre6">CRTL</b> key
			on your keyboard and click <b class="calibre6">LastName</b> <br class="calibre2" /><br class="calibre2" /><img
				src="images/image-75.png" alt="Image" class="calibre104" /><br class="calibre2" /> </li>
		<li class="block_16">In the ribbon, click on the <b class="calibre6">Transform</b> tab then click <b
				class="calibre6">Merge Columns</b> which is in the <i class="calibre7">Text Column</i> category<br
				class="calibre2" /> </li>
		<li class="block_16">Change the separator between the first and last name to be a <b class="calibre6">Space</b> and
			name the new column <b class="calibre6">Customer<br class="calibre2" /></b><br class="calibre2" /><img
				src="images/image-76.png" alt="Image" class="calibre105" /><br class="calibre2" /> </li>
		<li class="block_16">Click on <b class="calibre6">OK</b> to merge the two columns into the new column named <i
				class="calibre7">Customer</i> and note that a new applied step has appeared called <i class="calibre7">Merged
				Columns</i> in the <i class="calibre7">Query Settings </i>pane to the right of the window<br class="calibre2" /> 
		</li>
		<li class="block_16">Next, we do not want gender represented by the values F and M so we will replace these
			references, to do this select the <b class="calibre6">Gender </b>column<br class="calibre2" /> </li>
		<li class="block_16">In the <i class="calibre7">Transform</i> tab of the ribbon, click on <b class="calibre6">Replace
				Values</b> which can be found in the <i class="calibre7">Any Column</i> category<br class="calibre2" /><br
				class="calibre2" /><img src="images/image104.png" alt="Image" class="calibre106" /><br class="calibre2" /> </li>
		<li class="block_16">In the <i class="calibre7">Replace Values</i> menu, enter the value <b class="calibre6">M</b> to
			be replaced with the value <b class="calibre6">Male</b><br class="calibre2" /><img src="images/image-77.png"
				alt="Image" class="calibre107" /></li>
		<li class="block_16">Once you are ready, click <b class="calibre6">OK</b><br class="calibre2" /> </li>
		<li class="block_16">Repeat steps 10 and 11 and enter the value <b class="calibre6">F </b>to be replaced with <b
				class="calibre6">Female</b> and click <b class="calibre6">OK</b><br class="calibre2" /> </li>
		<li class="block_16">Notice there are two applied steps in the <i class="calibre7">Query Settings</i> pane on the
			right side of the window, <b class="calibre6">right click </b>on <i class="calibre7">Replaced Value</i> and choose
			<b class="calibre6">Rename</b><br class="calibre2" /><br class="calibre2" /><img src="images/image-78.png"
				alt="Image" class="calibre108" /><br class="calibre2" /> </li>
		<li class="block_16">Rename this applied step to <b class="calibre6">Update M to Male</b> then press <b
				class="calibre6">Enter </b>on your keyboard<br class="calibre2" /> </li>
		<li class="block_16">Repeat the previous step for the entry named <i class="calibre7">Replaced Value 1</i> renaming it
			to <b class="calibre6">Update F to Female</b><br class="calibre2" /><br class="calibre2" /><img
				src="images/image-79.png" alt="Image" class="calibre109" /><br class="calibre2" /> </li>
		<li class="block_16">Scroll the table of data to the right and you may notice we have three date/time columns that are
			formatted as text, being <i class="calibre7">BirthDate</i>, <i class="calibre7">FirstPurchaseDate</i> and <i
				class="calibre7">LastPurchaseDate</i><br class="calibre2" /> </li>
		<li id="id_Ret2" class="block_16">You can see the formatting applied based on the icon to the left of the column
			name<br class="calibre2" /><img src="images/image-80.png" alt="Image" class="calibre110" /></li>
		<li class="block_16">This icon is clickable, click on this icon for the <b class="calibre6">FirstPurchaseDate</b>
			column then choose <b class="calibre6">Date</b>, if you get errors in the column, this is a regional date format
			issue which can be resolved by clicking <a href="index_split_021.html#id_Err2" class="text_7">here</a><br
				class="calibre2" /><br class="calibre2" /><img src="images/image-81.png" alt="Image" class="calibre111" /><br
				class="calibre2" /> </li>
		<li class="block_16">Repeat the previous step for the <b class="calibre6">LastPurchaseDate</b> <br
				class="calibre2" /> </li>
		<li class="block_16">For the <b class="calibre6">BirthDate</b> column, format it as <b class="calibre6">Date/Time</b>
			<br class="calibre2" /><br class="calibre2" />Note that we could format it as Date, but it will generate an error.
			This is due to the text dd/mm/yyyy hh:mm being incompatible with the date field<br class="calibre2" /> </li>
		<li class="block_16">Now that it is formatted as Date/Time we can correctly switch it from <i
				class="calibre7">Date/Time</i> format to <b class="calibre6">Date</b>, when you do this, you will be asked to
			replace or create a new step, click <b class="calibre6">Add new step</b><br class="calibre2" /><br
				class="calibre2" /><img src="images/image-82.png" alt="Image" class="calibre112" /><br class="calibre2" /> </li>
		<li class="block_16">The <i class="calibre7">BirthDate</i> column will now be formatted as Date (it just took an extra
			step)<br class="calibre2" />Optional: Feel free to rename the applied steps for changing the column types e.g. <i
				class="calibre7">Format Purchase Date</i> and <i class="calibre7">Format Birth Date</i><br class="calibre2" /> 
		</li>
		<li class="block_16">Lastly in this table we will create a new conditional column to work out if our customer has only
			ever purchased a single item from House Rules Board Games, or whether they are repeat customers, to do this, in the
			<b class="calibre6">Add Column</b> tab choose <b class="calibre6">Conditional Column</b> from the <i
				class="calibre7">General</i> category<br class="calibre2" /><br class="calibre2" /><img src="images/image111.png"
				alt="Image" class="calibre113" /><br class="calibre2" /> </li>
		<li class="block_16">Configure the <i class="calibre7">If</i> statement as follows, do not forget to rename your
			column and switch your second property from <i class="calibre7">Enter a value</i> to <b class="calibre6">Select a
				column</b> as highlighted below<br class="calibre2" /><img src="images/image-83.png" alt="Image"
				class="calibre114" /></li>
		<li class="block_16">Once ready, click on <b class="calibre6">OK</b><br class="calibre2" /> </li>
		<li class="block_16">After reviewing the column, right-click and rename the applied step called <i
				class="calibre7">Added Conditional Column</i> to <i class="calibre7">Added Customer Type</i><br
				class="calibre2" /> </li>
		<li class="block_16">We no longer need the first and last purchase date columns, to remove them, click on <b
				class="calibre6">FirstPurchaseDate</b><br class="calibre2" /> </li>
		<li class="block_16">Now hold down the <b class="calibre6">CTRL</b> key on your keyboard and click on the <b
				class="calibre6">LastPurchaseDate</b> field<br class="calibre2" /><br class="calibre2" /><img
				src="images/image-84.png" alt="Image" class="calibre115" /><br class="calibre2" /> </li>
		<li class="block_16">In the <b class="calibre6">Home</b> tab of the ribbon, click on <b class="calibre6">Remove
				Columns</b> from the <i class="calibre7">Manage Columns</i> category<br class="calibre2" /><br
				class="calibre2" /><img src="images/image114.png" alt="Image" class="calibre116" /><br class="calibre2" /> </li>
		<li class="block_16">Format the new <i class="calibre7">Customer Type</i> column as <b class="calibre6">Text</b> <br
				class="calibre2" /><br class="calibre2" /><img src="images/image-85.png" alt="Image" class="calibre117" /></li>
		<li class="block_16">Finally, in the <i class="calibre7">Query Settings</i> pane on the right side of the window,
			rename the <i class="calibre7">Customer Records Sheet</i> to <b class="calibre6">Customers</b><br
				class="calibre2" /><br class="calibre2" /><img src="images/image-86.png" alt="Image" class="calibre118" /><br
				class="calibre2" /> </li>
		<li class="block_16">To save our work, but remain in Power Query, click on the <b class="calibre6">drop-down arrow</b>
			below <i class="calibre7">Close &amp; Apply</i> in the <i class="calibre7">Home</i> tab of the ribbon<br
				class="calibre2" /> </li>
		<li class="block_16">Click on the option <b class="calibre6">Apply</b><br class="calibre2" /><br
				class="calibre2" /><img src="images/image-87.png" alt="Image" class="calibre119" /><br class="calibre2" /> </li>
		<li class="block_24">Allow the system a moment to apply your query changes</li>
	</ol>
	<p id="id_Toc144885895" class="block_30">Products Query</p>
	<p class="block_">Next, we will look at the products table, which like the customer table has some unnecessary columns
		and some incorrect formatting. We will start creating a query for this table using some of the skills we have
		practiced in the customers table. Because you have already tried a few of these steps before, we will be a bit briefer
		in our delivery of steps to compensate for this.</p>
	<ol class="list_">
		<li class="block_15">In the <i class="calibre7">Queries</i> pane on the left side of the window, select the <b
				class="calibre6">Products Sheet</b> query<br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li class="block_16">In the <i class="calibre7">Home</i> tab of the ribbon, click on <b class="calibre6">Choose
				Columns</b><br class="calibre2" /> </li>
		<li class="block_16">Remove the following columns from the selection:</li>
	</ol>
	<ol class="list_1">
		<li class="block_22">ProductCode</li>
		<li class="block_22">Description</li>
		<li class="block_22">Invoice Details Sheet<br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li value="3" class="block_16">Once ready, click on <b class="calibre6">OK</b><br class="calibre2" /> </li>
		<li class="block_16"><b class="calibre6">Right click</b> on the column heading <b class="calibre6">Title</b> and
			choose <b class="calibre6">Rename</b><br class="calibre2" /> </li>
		<li class="block_16">Change the column heading to <b class="calibre6">Product</b> and press <b
				class="calibre6">Enter</b> on your keyboard<br class="calibre2" /> </li>
		<li class="block_16">Next, we will split up the product categories by <b class="calibre6">right clicking</b> on the <i
				class="calibre7">ProductCategory</i> column heading<br class="calibre2" /> </li>
		<li class="block_16">From the menu choose <b class="calibre6">Split Column</b> &gt; <b class="calibre6">By
				Delimiter…</b><br class="calibre2" /> </li>
		<li class="block_16">Configure the <i class="calibre7">Split Column by Delimiter</i> window as follows<b
				class="calibre6"><br class="calibre2" />IMPORTANT</b> in the configuration below there is a space either side of
			the &gt; character<br class="calibre2" /><img src="images/image-88.png" alt="Image" class="calibre120" /></li>
		<li class="block_16">Click <b class="calibre6">OK </b>to split the columns<br class="calibre2" /> </li>
		<li class="block_16"><b class="calibre6">Right click</b> on the following columns to use <b
				class="calibre6">Rename</b> to change the column title</li>
	</ol>
	<ol class="list_1">
		<li class="block_22">ProductCategory.1 is renamed to <b class="calibre6">Category</b></li>
		<li class="block_22">ProductCategory.2 is renamed to <b class="calibre6">Subcategory</b><br class="calibre2" /><img
				src="images/image-89.png" alt="Image" class="calibre121" /><br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li value="11" class="block_16">Lastly, using the <b class="calibre6">Format</b> button in the column heading, please
			update the format for the following columns</li>
	</ol>
	<ol class="list_1">
		<li class="block_22">UnitCost format as <b class="calibre6">Fixed Decimal Number</b></li>
		<li class="block_22">ListPrice format as <b class="calibre6">Fixed Decimal Number<br class="calibre2" /> </b></li>
	</ol>
	<ol class="list_">
		<li value="12" class="block_16">In the <i class="calibre7">Query Settings</i> pane on the right side of the window,
			rename the <i class="calibre7">Products Sheet</i> to <b class="calibre6">Products</b><br class="calibre2" /><br
				class="calibre2" /><img src="images/image-90.png" alt="Image" class="calibre122" /><br class="calibre2" /> </li>
		<li class="block_16">To save, click on the <b class="calibre6">drop-down arrow</b> below <i class="calibre7">Close
				&amp; Apply</i> in the <i class="calibre7">Home</i> tab of the ribbon<br class="calibre2" /> </li>
		<li class="block_24">Click on the option <b class="calibre6">Apply</b></li>
	</ol>
	<p id="id_Toc144885896" class="block_30">Invoice Details Sheet</p>
	<p class="block_">The next table is quite important as it will become the ‘facts table’ within our data model as it
		contains our event records. To do this we will need to hide some of the columns and expand related columns. This
		allows us to bring columns from other related tables into the current table, forging new relationships which can
		optimise our data model. We will review this change in the last exercise of this lab.</p>
	<ol class="list_">
		<li class="block_15">In the <i class="calibre7">Queries</i> pane on the left side of the window, select the <b
				class="calibre6">Invoice Details Sheet</b> query<br class="calibre2" /> </li>
		<li class="block_16">You can reorder columns by holding your <b class="calibre6">left mouse button</b> down on a
			column heading and dragging it either left or right, using this technique, reorder the columns as shown:<br
				class="calibre2" /><br class="calibre2" /><img src="images/image-91.png" alt="Image" class="calibre123" /><br
				class="calibre2" /> </li>
		<li class="block_16">Format the column named <b class="calibre6">SalesAmount</b> as <b class="calibre6">Fixed Decimal
				Number</b><br class="calibre2" /><br class="calibre2" /><img src="images/image-92.png" alt="Image"
				class="calibre124" /><br class="calibre2" /> </li>
		<li class="block_16">Next, we will copy columns from the related Invoices Sheet table, into the Invoice Details Sheet
			table, to do this click on the <b class="calibre6">Expand</b> button in the <i class="calibre7">Invoices Sheet</i>
			column heading<br class="calibre2" /><br class="calibre2" /><img src="images/image-93.png" alt="Image"
				class="calibre125" /><br class="calibre2" /> </li>
		<li class="block_16">In <i class="calibre7">Columns to Expand</i>, only select <b class="calibre6">InvoiceDate </b>and
			<b class="calibre6">CustomerId</b><br class="calibre2" /> </li>
		<li class="block_16">Untick <b class="calibre6">Use original column name as prefix</b><br class="calibre2" /><br
				class="calibre2" /><img src="images/image-94.png" alt="Image" class="calibre126" /><br class="calibre2" /> </li>
		<li class="block_16">Once you have selected your columns and deselected the naming prefix, click <b
				class="calibre6">OK</b>, allowing a moment for the process to complete<br class="calibre2" /> </li>
		<li class="block_16">Drag and drop the columns into the following order</li>
	</ol>
	<ol class="list_1">
		<li class="block_22">Id</li>
		<li class="block_22">InvoiceId</li>
		<li class="block_22">ProductId</li>
		<li class="block_22">CustomerId</li>
		<li class="block_22">InvoiceDate</li>
		<li class="block_22">Quantity</li>
		<li class="block_22">SalesAmount</li>
		<li class="block_22">Products Sheet<br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li value="9" class="block_16">Change the format of the <b class="calibre6">InvoiceDate</b> column to <b
				class="calibre6">Date</b> <br class="calibre2" /> </li>
		<li class="block_16">Rename the column from <i class="calibre7">InvoiceDate </i>to <b
				class="calibre6">PurchaseDate</b><br class="calibre2" /> </li>
		<li class="block_16">Next, click <b class="calibre6">Expand</b> on the <i class="calibre7">Products Sheet</i>
			column<br class="calibre2" /><br class="calibre2" /><img src="images/image-95.png" alt="Image"
				class="calibre127" /><br class="calibre2" /> </li>
		<li class="block_16">Only select <b class="calibre6">UnitCost</b> and click <b class="calibre6">OK</b><br
				class="calibre2" /> </li>
		<li class="block_16">Format the <i class="calibre7">UnitCost</i> column as <b class="calibre6">Fixed Decimal
				Number</b><br class="calibre2" /> </li>
		<li class="block_16">The reason to bring the unit cost from our products table into our invoice details is to multiply
			it by the quantity column to give us a product cost, which we will add as a new column, to do this click on the <b
				class="calibre6">Add Column</b> tab in the ribbon and select <b class="calibre6">Custom Column</b><br
				class="calibre2" /> </li>
		<li class="block_16">Name the column <b class="calibre6">ProductCost</b> and then use the available columns to create
			the formula <b class="calibre6">=[Quantity] * [UnitCost]</b><br class="calibre2" /> </li>
		<li class="block_16">Click <b class="calibre6">OK </b>once you have configured your custom column<br
				class="calibre2" /><br class="calibre2" /><img src="images/image-96.png" alt="Image" class="calibre128" /><br
				class="calibre2" /> </li>
		<li class="block_16">Format the new <b class="calibre6">ProductCost</b> column as <b class="calibre6">Fixed Decimal
				Number<br class="calibre2" /> </b></li>
		<li class="block_16">Now we have our custom column, we no longer need <i class="calibre7">UnitCost</i><span
				class="text_9"> </span>so we can safely remove it by <b class="calibre6">right clicking</b> on <b
				class="calibre6">UnitCost</b> and selecting <b class="calibre6">Remove</b><br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li value="19" class="block_16">Lastly, in the <i class="calibre7">Query Settings</i> pane on the right side of the
			window, rename the <i class="calibre7">Invoice Details Sheet</i> to <b class="calibre6">Sales</b><br
				class="calibre2" /><br class="calibre2" /><img src="images/image-97.png" alt="Image" class="calibre129" /><br
				class="calibre2" /> </li>
		<li class="block_16">To save, in the <b class="calibre6">Home</b> tab of the ribbon, click on the <b
				class="calibre6">drop-down arrow</b> below <i class="calibre7">Close &amp; Apply</i> <br class="calibre2" /> </li>
		<li class="block_24">Click on the option <b class="calibre6">Apply</b></li>
	</ol>
	<p id="id_Toc144885897" class="block_30">Invoices Sheet</p>
	<p class="block_">We are now at our last query, and there is not too much to do here. We have an objective to replace
		less friendly terms like an InPerson/MailOrder/Online invoice to something more palatable. </p>
	<ol class="list_">
		<li class="block_15">In the <i class="calibre7">Queries</i> pane on the left side of the window, select the <b
				class="calibre6">Invoices Sheet</b> query<br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li value="2" class="block_16">From the <i class="calibre7">Home</i> tab, click on <b class="calibre6">Choose
				Columns</b> and select only the following columns</li>
	</ol>
	<ol class="list_1">
		<li class="block_22">InvoiceId</li>
		<li class="block_22">InvoiceType<br class="calibre2" /> </li>
	</ol>
	<ol class="list_">
		<li value="3" class="block_16">Leave the remaining columns unselected then click <b class="calibre6">OK</b> <br
				class="calibre2" /> </li>
		<li class="block_16">Select the <b class="calibre6">InvoiceType</b> column<br class="calibre2" /> </li>
		<li class="block_16">To change the values in the <i class="calibre7">InvoiceType</i> column, select the <b
				class="calibre6">Transform</b> tab in the ribbon, then choose <b class="calibre6">Replace Values</b><br
				class="calibre2" /> </li>
		<li class="block_16">Replace <i class="calibre7">InPerson</i> with <b class="calibre6">Store Purchase</b> and click <b
				class="calibre6">OK</b><br class="calibre2" /> </li>
		<li class="block_16">Repeat step 5 and change the following values</li>
	</ol>
	<ol class="list_1">
		<li class="block_22">Replace <i class="calibre7">MailOrder</i> with <b class="calibre6">Mail Order Purchase</b></li>
		<li class="block_22">Replace <i class="calibre7">Online</i> with <b class="calibre6">Online Purchase<br
					class="calibre2" /> </b></li>
	</ol>
	<ol class="list_">
		<li value="8" class="block_16">Now rename the <i class="calibre7">InvoiceType</i> column to <b
				class="calibre6">Purchase Type</b><br class="calibre2" /> </li>
		<li class="block_16">Lastly, in the <i class="calibre7">Query Settings</i> pane on the right side of the window,
			rename the <i class="calibre7">Invoices Sheet</i> to <b class="calibre6">Purchases</b> and press <b
				class="calibre6">Enter</b><br class="calibre2" /><br class="calibre2" /><img src="images/image-98.png" alt="Image"
				class="calibre130" /><br class="calibre2" /> </li>
		<li class="block_23">To save, click on <b class="calibre6">Close &amp; Apply</b> (the top half of the Close &amp;
			Apply button) in the <b class="calibre6">Home</b> tab of the ribbon which will close Power Query Editor</li>
	</ol>
	<p id="id_Toc144885898" class="block_14">Exercise 4 – Review the table relationships</p>
	<p class="block_">Once our queries have been applied, they will refine the data within our model. In our query we
		expanded some columns, which brought related columns from other tables into the current table. We also removed other
		columns that previously formed relationships across tables. This was deliberate, as we were attempting to move our ID
		columns into a central table, the Sales table, with the other tables gaining a one hop relationship to it. Before we
		started this exercise, our data model looked like this:</p>
	<p class="block_"><img src="images/image-99.png"
			alt="Graphical user interface&#10;&#10;Description automatically generated" class="calibre131" /></p>
	<ol class="list_">
		<li class="block_15">To review the new data model, click on the <b class="calibre6">Model </b><img
				src="images/image130.png" alt="Image" class="calibre132" /><b class="calibre6"> </b>button in the rail menu<br
				class="calibre2" /><br class="calibre2" /><img src="images/image-100.png" alt="Image" class="calibre133" /><br
				class="calibre2" /> </li>
		<li class="block_16">Our data model resembles the one below, note that there is no longer a relationship between
			Customers and Purchases as the CustomerId was removed from the Purchases table, but it was added to the Sales table
			(use the zoom slider at the bottom of model view to see all of the tables, you can also collapse the panes on the
			right too)<br class="calibre2" /><br class="calibre2" /><img src="images/image-101.png"
				alt="Graphical user interface, application, Teams&#10;&#10;Description automatically generated"
				class="calibre134" /><br class="calibre2" /> </li>
		<li class="block_16">In the <i class="calibre7">Home</i> tab of the ribbon, click on <b class="calibre6">Manage
				Relationships</b><br class="calibre2" /> </li>
		<li class="block_16">Click on <b class="calibre6">Autodetect…</b> and you should find one new relationship, then click
			<b class="calibre6">Close</b><br class="calibre2" /><br class="calibre2" /><img src="images/image-102.png"
				alt="Image" class="calibre135" /><br class="calibre2" /> </li>
		<li class="block_24">A new relationship is forged between the <i class="calibre7">Sales</i> and <i
				class="calibre7">Customer</i> table as they both have the CustomerId column<br class="calibre2" /> </li>
	</ol>
	<p class="block_25" id="calibre_pb_10"> </p>
</body>
</html>