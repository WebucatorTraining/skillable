<body class="calibre">
<p class="block_7" id="id_Toc116995131">Lab 2 – Create tables and relationships</p>
<p class="block_"><img alt="A picture containing text  Description automatically generated" class="calibre15" src="images/image-13.png"/></p>
<p class="block_15" id="id_Toc116995132">Exercise 1: Add a blank app to your team</p>
<p class="block_">To set up Microsoft Dataverse for Teams, we must create an environment for your team. To do this we must add a new app to your Team. Although we will not be focusing on this new app in the current lab, we will come back to it in our next lab.</p>
<ol class="list_">
<li class="block_24">In your left navigation in Microsoft Teams, select <b class="calibre5">Power Apps</b> if it is not already selected<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre35" src="images/image28.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">Create an app</b> button<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre36" src="images/image29.png"/><br class="calibre6"/> </li>
<li class="block_25">From the <i class="calibre7">Select a team</i> drop-down choose the name of your team<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre37" src="images/image30.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, choose <b class="calibre5">Create</b>, the process of creating an environment can take up to a minute<br class="calibre6"/> </li>
<li class="block_25">Once ready, the app designer will load, when asked to name the app, enter <b class="calibre5">Expense Claims</b> and click <b class="calibre5">Save</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre38" src="images/image31.png"/></li>
<li class="block_27">Leave the designer open for the next exercise<br class="calibre6"/> </li>
</ol>
<p class="block_15" id="id_Toc116995133">Exercise 2: Setup two new tables</p>
<p class="block_">Next, we will use the shortcut in the Power Apps designer to create a new table. This table will support our departments submissions for personal expense claims. We will attribute columns to the table which will outline the required information for a claim. We will then add a second table for claim approvers, which can be referenced from the claims table using a lookup column.</p>
<ol class="list_">
<li class="block_24">Within the Power Apps designer, from the <i class="calibre7">Data </i>pane choose <b class="calibre5">Create new table</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre39" src="images/image32.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25">Name the table <b class="calibre5">Claims</b> and then click <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">Name</b> column heading, and choose <b class="calibre5">Edit column</b><br class="calibre6"/> </li>
<li class="block_25">Change the name of the column to <b class="calibre5">Claim description</b> and choose <b class="calibre5">Save<br class="calibre6"/> </b></li>
<li class="block_25">Next add the following columns: <br class="calibre6"/> </li>
</ol>
<ol class="list_1">
<li class="block_33">Choose <b class="calibre5">+ Add column</b> from the ribbon or choose <b class="calibre5">[ + ]</b> to the right of the <i class="calibre7">Claim description </i>column<br class="calibre6"/> </li>
<li class="block_33">Name the column <b class="calibre5">Cost</b> and for the column type choose <b class="calibre5">Decimal</b> and click <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_33">Add another column called <b class="calibre5">Submission date</b> with the type set to <b class="calibre5">Date</b> and click <b class="calibre5">Create<br class="calibre6"/> </b></li>
<li class="block_33">Add another column called <b class="calibre5">Claim status</b> with the type set to <b class="calibre5">Choice</b> and use the <i class="calibre7">Choices</i> options to create:<br class="calibre6"/> </li>
</ol>
<ol class="list_2">
<li class="block_34">Submitted</li>
<li class="block_34">Approved</li>
<li class="block_34">Declined<br class="calibre6"/> </li>
</ol>
<ol class="list_1">
<li class="block_33" value="5">Then choose <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_33">Lastly, create a column called <b class="calibre5">ClaimID </b>and set the type to <b class="calibre5">Auto number</b> then click <b class="calibre5">Advanced options </b>and add the <i class="calibre7">Prefix</i> <b class="calibre5">CLAIM </b>and set the <i class="calibre7">Minimum number of digits</i> to <b class="calibre5">8</b> (we recommend double checking these settings as they are important) then choose <b class="calibre5">Create<br class="calibre6"/> </b></li>
</ol>
<ol class="list_">
<li class="block_25" value="5">Now that the table has its columns, choose <b class="calibre5">Close</b><br class="calibre6"/> </li>
<li class="block_25">The <i class="calibre7">Data</i> pane will update to show your table and the app will automatically connect your new Claims table to the gallery and form within the app<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre40" src="images/image33.png"/><br class="calibre6"/><br class="calibre6"/> </li>
<li class="block_25">To create another table, in the <i class="calibre7">Data</i> pane, click <b class="calibre5">+ Add data</b> and then choose <b class="calibre5">+ Create new table </b>(if + Add data is not present, in the ribbon click <b class="calibre5">Save</b>, click on the <b class="calibre5">Build</b> tab above the ribbon, select your <b class="calibre5">team </b>and then the app named <b class="calibre5">Expense Claims</b> and resume step 8)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre41" src="images/image-14.png"/><br class="calibre6"/> </li>
<li class="block_25">Name the table <b class="calibre5">Department Approvers</b> and click <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_25">Create a new column called <b class="calibre5">Maximum approval amount</b> and set the type to <b class="calibre5">Number</b> and choose <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_32">Below the field headings, use the <i class="calibre7">Enter </i>text and Enter<i class="calibre7"> number</i> references to create the following rows in the table:</li>
</ol>
<table class="table_2">
<tbody class="calibre25"><tr class="calibre26">
<td class="td_8"><p class="block_35">Name</p></td>
<td class="td_9"><p class="block_35">Maximum approval amount</p></td>
</tr>
<tr class="calibre26">
<td class="td_10"><p class="block_30">Steve Smith</p></td>
<td class="td_11"><p class="block_30">50,000</p></td>
</tr>
<tr class="calibre26">
<td class="td_10"><p class="block_30">Amrita Shekhar</p></td>
<td class="td_11"><p class="block_30">150,000</p></td>
</tr>
<tr class="calibre26">
<td class="td_12"><p class="block_30">Victoria Gray</p></td>
<td class="td_13"><p class="block_30">250,000</p></td>
</tr>
</tbody></table>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_25" value="11">Add <span class="text_8">your own name</span> as it appears in Teams (click on your profile logo as shown below) and choose an amount of money you feel comfortable approving<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre42" src="images/image-15.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on the column heading <b class="calibre5">Maximum approval amount</b> and sort the column from <b class="calibre5">Smaller to larger</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre43" src="images/image36.png"/><br class="calibre6"/> </li>
<li class="block_25">The result will be similar to the table shown below, with your custom information replacing the bottom row<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre44" src="images/image37.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, click <b class="calibre5">Close<br class="calibre6"/> </b></li>
<li class="block_25">The last step in our table setup is to add our approvers as a lookup from the Claims table, in the <i class="calibre7">Data</i> tab, if the <i class="calibre7">Select a data source</i> menu is open, click <b class="calibre5">X</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre45" src="images/image-16.png"/><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">Data </i>pane, click on the <b class="calibre5">ellipsis (…)</b> next to the <i class="calibre7">Claims</i> table (if the table is not in the list, click on the <b class="calibre5">+ Add data</b> button again and select the <i class="calibre7">Claims</i> and <i class="calibre7">Department Approvers</i> tables)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre46" src="images/image-17.png"/><br class="calibre6"/> </li>
<li class="block_25">Select <b class="calibre5">Edit data</b><br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Add column</b> and enter <b class="calibre5">Approver </b>as the column name and set the type to <b class="calibre5">Lookup</b><br class="calibre6"/> </li>
<li class="block_25">Next, set the <i class="calibre7">Related table </i>to <b class="calibre5">Department Approvers</b> and choose <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_25">Scroll to the right of the table and click on the column heading titled <b class="calibre5">Approver</b> then choose <b class="calibre5">Move left</b> (this should mean the <i class="calibre7">ClaimID</i> column is the last column in the table)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre47" src="images/image40.png"/><br class="calibre6"/> </li>
<li class="block_32">Lastly add the following data to the table<br class="calibre6"/><br class="calibre6"/><b class="calibre5">TIP: </b>Double click on the <b class="calibre5">blank fields</b>, they can take a moment to populate</li>
</ol>
<table class="table_3">
<tbody class="calibre25"><tr class="calibre26">
<td class="td_14"><p class="block_35">Claim description</p></td>
<td class="td_15"><p class="block_35">Cost</p></td>
<td class="td_16"><p class="block_35">Submission date</p></td>
<td class="td_17"><p class="block_35">Claim status</p></td>
<td class="td_18"><p class="block_35">Approver</p></td>
</tr>
<tr class="calibre26">
<td class="td_19"><p class="block_30">Jan trip to DC</p></td>
<td class="td_20"><p class="block_30">459.83</p></td>
<td class="td_21"><p class="block_30">[Today]</p></td>
<td class="td_22"><p class="block_30">Approved</p></td>
<td class="td_23"><p class="block_30">Steve Smith</p></td>
</tr>
<tr class="calibre26">
<td class="td_19"><p class="block_30">Dec taxi to party</p></td>
<td class="td_20"><p class="block_30">15.34</p></td>
<td class="td_21"><p class="block_30">Pick a date in December </p></td>
<td class="td_22"><p class="block_30">Approved</p></td>
<td class="td_23"><p class="block_30">Amrita Shekhar</p></td>
</tr>
<tr class="calibre26">
<td class="td_24"><p class="block_30">Training course</p></td>
<td class="td_25"><p class="block_30">799.99</p></td>
<td class="td_26"><p class="block_30">Pick any date in the past</p></td>
<td class="td_27"><p class="block_30">Approved</p></td>
<td class="td_28"><p class="block_30">Victoria Gray</p></td>
</tr>
</tbody></table>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_25" value="22">Once ready, click <b class="calibre5">Close<br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre48" src="images/image41.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_27">Your tables are now ready!</li>
</ol>
<p class="block_15" id="id_Toc116995134">Exercise 3: Set table security</p>
<p class="block_">Being able to set up our tables in Microsoft Dataverse for Teams whilst building an app is a great benefit. However, we will need to restrict members of our team from seeing claims that are not their own. To do this we will update our table security. This cannot be done from the Power Apps designer; we will need to manage the tables from the Dataverse for Teams items list.</p>
<ol class="list_">
<li class="block_24">At the top of the Power Apps designer, in the ribbon click <b class="calibre5">Save<br class="calibre6"/> </b></li>
<li class="block_25">Next, above the ribbon, click on the <b class="calibre5">Build</b> tab (you will still need to click this tab, even if it is already selected)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre49" src="images/image42.png"/><br class="calibre6"/> </li>
<li class="block_25">On the build tab, ensure that your Team is selected in the left navigation<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre50" src="images/image43.png"/><br class="calibre6"/> </li>
<li class="block_25">Below the items list, click on <b class="calibre5">See all</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre51" src="images/image-18.png"/><br class="calibre6"/> </li>
<li class="block_25">In the list filters on the left of the app, click on <b class="calibre5">Tables</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre52" src="images/image45.png"/><br class="calibre6"/> </li>
<li class="block_25">On the list click on the <b class="calibre5">ellipsis (…)</b> to the right of the <i class="calibre7">Claims</i> table and choose <b class="calibre5">Manage permissions</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre53" src="images/image46.png"/><br class="calibre6"/> </li>
<li class="block_25">With <i class="calibre7">Member </i>selected by default on the left, change the level of access for these users to <b class="calibre5">Private<br class="calibre6"/></b><br class="calibre6"/><img alt="Image" class="calibre54" src="images/image47.png"/><br class="calibre6"/> </li>
<li class="block_25">At the bottom of the menu click <b class="calibre5">Save</b><br class="calibre6"/> </li>
<li class="block_25">Next, click on the <b class="calibre5">ellipsis (…)</b> to the right of the <i class="calibre7">Department Approvers</i> table and choose <b class="calibre5">Manage permissions</b><br class="calibre6"/> </li>
<li class="block_25">With <i class="calibre7">Members </i>selected by default, change this audiences access to <b class="calibre5">Reference</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre55" src="images/image48.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, select the <b class="calibre5">Guest</b> group in the left navigation of the current menu and change their access to <b class="calibre5">Reference</b> as well<br class="calibre6"/> </li>
<li class="block_25">Lastly, click <b class="calibre5">Save</b><br class="calibre6"/> </li>
<li class="block_25">In the left navigation click <b class="calibre5">Apps</b> as shown below<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre56" src="images/image-19.png"/><br class="calibre6"/> </li>
<li class="block_25">Leave this open for the next lab<br class="calibre6"/> </li>
</ol>
<p class="block_26"> </p>
</body>
<body class="calibre">
<p class="block_7" id="id_Toc116995135">Lab 3 – Create a new app</p>
<p class="block_"><img alt="Graphical user interface, text, application  Description automatically generated" class="calibre15" src="images/image-20.png"/></p>
<p class="block_15" id="id_Toc116995136">Exercise 1: Return to your blank app</p>
<p class="block_">In our previous lab, we left our app to customise our table security. In this exercise we will navigate back to the app so that we can continue working on it.</p>
<ol class="list_">
<li class="block_24">Starting from the previous lab, click on the <b class="calibre5">Expense Claims</b> app<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre57" src="images/image-21.png"/><br class="calibre6"/> </li>
</ol>
<p class="block_36">If you are not on this page, please select the <b class="calibre5">Power Apps</b> from your left navigation in Microsoft Teams, then select the <b class="calibre5">Build</b> tab, select your team, and then click on <b class="calibre5">Expense Claims</b><br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="2">Allow the designer a moment to launch<br class="calibre6"/> </li>
<li class="block_25">Once the app has loaded, close the <i class="calibre7">Data</i> pane to offer you some more space to view your canvas<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre58" src="images/image52.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">Fit to window</b> button, below the canvas<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre59" src="images/image-22.png"/><br class="calibre6"/> </li>
<li class="block_27">The app should now fit the screen</li>
</ol>
<p class="block_15" id="id_Toc116995137">Exercise 2: Add screens, formulas and controls</p>
<p class="block_">With the app designer ready we will now build an app for logging personal expense claims. Because Power Apps has put together a functioning screen for us already, we will explore what this designer has to offer by introducing two new screens. The first screen will be the home screen, used to pick whether to view existing claims or submit a new one. We will then build a screen for submitting new requests. We have broken this exercise into smaller segments to aid with the design process.</p>
<p class="block_37" id="id_Toc116995138">Adding and naming screens</p>
<ol class="list_">
<li class="block_24">In the ribbon, click <b class="calibre5">New screen</b> <br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25">From the menu select <b class="calibre5">Header, main section, footer</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre60" src="images/image54.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the <b class="calibre5">New screen</b> option once more in the ribbon<br class="calibre6"/> </li>
<li class="block_25">Choose <b class="calibre5">Sidebar</b> to add the next screen to the app<br class="calibre6"/> </li>
<li class="block_25">In the toolbar, choose <b class="calibre5">Tree view</b> <img alt="Image" class="calibre61" src="images/image55.png"/><br class="calibre6"/> </li>
<li class="block_25">Position your mouse cursor over <i class="calibre7">Screen1</i> to reveal the <b class="calibre5">ellipsis (…)</b> and select it<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre62" src="images/image-23.png"/></li>
<li class="block_25">Choose <b class="calibre5">Rename</b> <br class="calibre6"/> </li>
<li class="block_25">Change the name of the screen to <b class="calibre5">Expense Claims List </b>and press <b class="calibre5">Enter</b> on your keyboard<b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">Using the <i class="calibre7">Rename</i> option, change the following screen names:<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_38">Update <i class="calibre7">Screen2</i> to <b class="calibre5">Home</b><br class="calibre6"/> </li>
<li class="block_38">Update <i class="calibre7">Screen3</i> to <b class="calibre5">New Claim</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre63" src="images/image57.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25" value="9">To ensure your home screen is the first to be shown when the app loads, position your mouse cursor over the <i class="calibre7">Home</i> screen and click on the <b class="calibre5">ellipsis (…)</b> and choose <b class="calibre5">Move up</b><br class="calibre6"/> </li>
<li class="block_25">The home screen should now be the top-most screen in the app<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre64" src="images/image58.png"/><br class="calibre6"/> </li>
</ol>
<p class="block_39">Now that the screens are ready, we will work on each screen individually by adding controls, formulas and inserting media where needed, to summarise, the function of each screen, please review the list below:<br class="calibre6"/> </p>
<ul class="list_3">
<li class="block_40"><b class="calibre5">Home</b> – Provides a little branding and navigation to the other two screens</li>
</ul>
<p class="block_41"> </p>
<ul class="list_3">
<li class="block_40"><b class="calibre5">Expense Claims List</b> – A gallery displaying the users claims, allowing them to edit their claims and view their status (owners of the Team can manage all records thanks to the table security)</li>
</ul>
<p class="block_41"> </p>
<ul class="list_3">
<li class="block_40"><b class="calibre5">New Claim</b> – A page that quickly allows users to create a new claim via a form<br class="calibre6"/> </li>
</ul>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_25" value="11">At the top right of the page, click <b class="calibre5">Save<br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre65" src="images/image-24.png"/><br class="calibre6"/> </li>
</ol>
<p class="block_42"><br class="calibre6"/> </p>
<p class="block_37" id="id_Toc116995139">Add a form and controls to the New Claim screen</p>
<ol class="list_">
<li class="block_24">In the toolbar with <b class="calibre5">Tree view</b> <img alt="Image" class="calibre61" src="images/image55.png"/> selected, click on the screen titled <b class="calibre5">New Claim</b><br class="calibre6"/> </li>
<li class="block_25">Select the <b class="calibre5">HeaderContainer2</b> at the top right of the screen<br class="calibre6"/> </li>
<li class="block_25">Next, in the toolbar click on <b class="calibre5">+ Insert</b> <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre66" src="images/image-25.png"/></li>
<li class="block_25">With the container selected, use the <i class="calibre7">Insert</i> toolbar to add the following to the container<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_38">An <b class="calibre5">Icon</b></li>
<li class="block_38">A second <b class="calibre5">Icon<br class="calibre6"/> </b></li>
</ol>
<p class="block_36">The controls should appear within the container, if not, delete the controls, by selecting them and pressing <b class="calibre5">Del</b> on your keyboard, and repeat step 5 but ensure the container is selected<br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="5">Select the left icon<br class="calibre6"/> </li>
<li class="block_25">Update the properties as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre67" src="images/image61.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the remaining icon on the right, and update its properties as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre68" src="images/image62.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the top-right container <i class="calibre7">HeaderContainer2</i> once more<br class="calibre6"/> </li>
<li class="block_25">Set the properties of the <i class="calibre7">HeaderContainer</i> to the following<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre69" src="images/image63.png"/><br class="calibre6"/> </li>
<li class="block_25">Your icons should position as follows:<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre70" src="images/image64.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the <b class="calibre5">SidebarContainer1</b> which is the container on the left of the screen<br class="calibre6"/> </li>
<li class="block_25">Using <b class="calibre5">+ Insert</b> from the toolbar, add a <b class="calibre5">Label</b> control<br class="calibre6"/> </li>
<li class="block_25">Select the new Label control within the container, and using the properties pane with the <i class="calibre7">Properties</i> tab selected, update the following fields<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre71" src="images/image65.png"/><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">properties pane</i> click on the <b class="calibre5">Advanced </b>tab and enter <i class="calibre7">Width</i> into the search box<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre72" src="images/image66.png"/><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">Width</i> field enter <b class="calibre5">Parent.Width</b> this means that as the flexible container collapses based on the width of the screen, the label control will also reduce in size<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre73" src="images/image67.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the left container <b class="calibre5">SidebarContainer1</b> again, click on the <b class="calibre5">Properties</b> tab in the <i class="calibre7">properties pane</i> and change its properties to the following<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre74" src="images/image68.png"/><br class="calibre6"/> </li>
<li class="block_25">Next select the container named <b class="calibre5">MainSectionContainer2</b> <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre75" src="images/image69.png"/><br class="calibre6"/> </li>
<li class="block_25">Using <b class="calibre5">+ Insert</b> from the toolbar, add an <b class="calibre5">Edit Form</b> control<br class="calibre6"/> </li>
<li class="block_25">In the toolbar open <b class="calibre5">Tree view</b> <img alt="Image" class="calibre61" src="images/image55.png"/> and the new edit form titled <i class="calibre7">Form1</i> should be selected, click on the <b class="calibre5">ellipsis (…) </b>to the right of the control select <b class="calibre5">Rename</b>, change the controls name to <b class="calibre5">NewClaimForm</b>, this will help us select the correct form in a formula later<br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">properties pane</i> with the <i class="calibre7">NewClaimForm </i>control selected check to make sure the <b class="calibre5">Properties</b> tab is highlighted<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre76" src="images/image-26.png"/></li>
<li class="block_25">Click on the <b class="calibre5">drop-down</b> for the <i class="calibre7">Data source</i> property and choose <b class="calibre5">Claims</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre77" src="images/image-27.png"/><br class="calibre6"/> </li>
<li class="block_25">Select <b class="calibre5">Edit fields</b> from the <i class="calibre7">Properties</i> tab<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre78" src="images/image-28.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on <b class="calibre5">+ Add field</b><br class="calibre6"/> </li>
<li class="block_25">Place a <b class="calibre5">Tick</b> next to the <i class="calibre7">Approver</i> column and choose <b class="calibre5">Add</b><br class="calibre6"/> </li>
<li class="block_25">Remove the <i class="calibre7">Claim Status </i>and <i class="calibre7">ClaimID</i> fields from this form by clicking on the <b class="calibre5">ellipsis (…) </b>next to each field and choose <b class="calibre5">Remove</b>, then confirm both fields are gone <br class="calibre6"/> </li>
<li class="block_25">Close the <i class="calibre7">Fields</i> pane by clicking <b class="calibre5">X<br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre79" src="images/image-29.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">In the <i class="calibre7">properties pane</i> click on the <b class="calibre5">Advanced </b>tab and enter <i class="calibre7">Width</i> into the search box<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre72" src="images/image66.png"/><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">Width</i> field enter <b class="calibre5">Parent.Width</b> this means that as the flexible container collapses based on the width of the screen, the form control will also reduce in size<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre73" src="images/image67.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">To allow data that is added to the form to be saved to the Claims table, select the <b class="calibre5">Save</b> icon in the container above the form<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre80" src="images/image74.png"/><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">properties pane</i> click on the <b class="calibre5">Advanced</b> tab (if not already selected)<br class="calibre6"/> </li>
<li class="block_25">Change the <i class="calibre7">OnSelect</i> property to: <b class="calibre5">SubmitForm(NewClaimForm);Navigate(Home) <br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre81" src="images/image75.png"/></li>
</ol>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_25" value="32">Select the <b class="calibre5">Home</b> icon next to the <i class="calibre7">Save</i> icon<br class="calibre6"/> </li>
<li class="block_25">The <i class="calibre7">properties pane</i> will remain on the <i class="calibre7">Advanced</i> tab, change the <i class="calibre7">OnSelect</i> property to: <b class="calibre5">Navigate(Home)</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre82" src="images/image76.png"/><br class="calibre6"/> </li>
<li class="block_25">Your save button is now configured save your data in the form to your claims table then return to the home screen, and the home button simply returns to the home screen<br class="calibre6"/> </li>
<li class="block_25">To add the home button to the <i class="calibre7">Expense Claims List</i> screen, <b class="calibre5">right-click</b> on the <b class="calibre5">Home</b> icon and choose <b class="calibre5">Copy<br class="calibre6"/> </b></li>
</ol>
<p class="block_36"><img alt="Image" class="calibre83" src="images/image-30.png"/></p>
<ol class="list_">
<li class="block_25" value="36">In the toolbar, select <b class="calibre5">Tree view</b> <img alt="Image" class="calibre61" src="images/image55.png"/> and then select the <b class="calibre5">Expense Claims List </b>screen<br class="calibre6"/> </li>
<li class="block_25"><b class="calibre5">Right-click</b> on the <i class="calibre7">top-left container</i> and choose <b class="calibre5">Paste </b>(see example on the following page)<b class="calibre5"><br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre84" src="images/image-31.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">This type of container allows you to freely drag and drop the icon, try and move the icon so its position is similar to the image below<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre85" src="images/image-32.png"/><br class="calibre6"/> </li>
<li class="block_25">To test the button, hold down the <b class="calibre5">ALT</b> key on your keyboard and then click on the <b class="calibre5">Home</b> button that you added to the navigation, you should be taken to the <i class="calibre7">Home </i>screen<br class="calibre6"/> </li>
<li class="block_32">At the top right of the designer, click <b class="calibre5">Save</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre65" src="images/image-24.png"/></li>
</ol>
<p class="block_37" id="id_Toc116995140">Design the home screen</p>
<ol class="list_">
<li class="block_24">With the <b class="calibre5">Home</b> screen selected in <i class="calibre7">Tree view</i> click on <b class="calibre5">MainSectionContainer1</b> within the screen<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre86" src="images/image-33.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25">Next, click on <b class="calibre5">+ Insert</b> in the toolbar<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre66" src="images/image-25.png"/><br class="calibre6"/> </li>
<li class="block_25">Choose <b class="calibre5">Button<br class="calibre6"/> </b></li>
<li class="block_25">With the button selected, try to move it; because we are working in a horizontal container which has a responsive design (meaning it formats the app to work on different sized screens) we can only organise the button within the context of the container<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre87" src="images/image81.png"/><br class="calibre6"/> </li>
<li class="block_25">With the button selected, the <i class="calibre7">properties pane</i> on the right side of the designer will update, click on the <b class="calibre5">Properties </b>tab then change the following fields<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre88" src="images/image82.png"/><br class="calibre6"/> </li>
<li class="block_25">Before we add another button, we will use a rectangle to space the buttons out, firstly ensure <b class="calibre5">MainSectionContainer1</b> is selected which is the middle container<br class="calibre6"/> </li>
<li class="block_25">Using the <b class="calibre5">+ Insert</b> button in the toolbar, choose <b class="calibre5">Rectangle<br class="calibre6"/> </b></li>
<li class="block_25">In the <i class="calibre7">properties pane</i> change the following options<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre89" src="images/image83.png"/><br class="calibre6"/> </li>
<li class="block_25"><b class="calibre5">Right-click</b> on the <i class="calibre7">New Claim </i>button<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre90" src="images/image84.png"/><br class="calibre6"/> </li>
<li class="block_25">Select <b class="calibre5">Copy</b>, then <b class="calibre5">right-click</b> on the middle container and choose <b class="calibre5">Paste</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre91" src="images/image85.png"/><br class="calibre6"/> </li>
<li class="block_25">With the second button selected, in the <i class="calibre7">properties pane</i> change the <i class="calibre7">Text</i> property to <b class="calibre5">Claims List</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre92" src="images/image86.png"/><br class="calibre6"/> </li>
<li class="block_25">To control where the buttons navigate to, with the <i class="calibre7">Claims List</i> button still selected, select the <b class="calibre5">Advanced</b> tab in the <i class="calibre7">properties pane</i><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre93" src="images/image-34.png"/><br class="calibre6"/> </li>
<li class="block_25">For the <i class="calibre7">OnSelect</i> property which controls what the button does when clicked, enter this formula: <b class="calibre5">Navigate('Expense Claims List')</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre94" src="images/image88.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the button named <b class="calibre5">New Claim</b> (above the <i class="calibre7">Claims List</i> button)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre95" src="images/image-35.png"/><br class="calibre6"/> </li>
</ol>
<p class="block_39">Note that the <i class="calibre7">properties pane </i>will remain in <i class="calibre7">Advanced</i> mode, click the <i class="calibre7">OnSelect</i> field and enter the following formula: <b class="calibre5">Navigate('New Claim');NewForm(NewClaimForm) </b></p>
<p class="block_28"> </p>
<p class="block_36"><img alt="Image" class="calibre96" src="images/image90.png"/><br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="14">Select <b class="calibre5">HeaderContainer1</b> which is the container at the top of the <i class="calibre7">Home</i> screen<br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">properties pane</i> update the following in the <b class="calibre5">Properties</b> tab<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre97" src="images/image91.png"/><br class="calibre6"/> </li>
<li class="block_25">With the container still selected, in the toolbar click on <b class="calibre5">+ Insert</b>, expand the <b class="calibre5">Media</b> category, and choose <b class="calibre5">Image</b><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">properties pane</i> with the <i class="calibre7">Properties </i>tab selected, configure the control as follows, using the option <b class="calibre5">+ Add an image file </b>to insert an image file from your computer <br class="calibre6"/>(note the field <i class="calibre7">Minimum height</i> is also <i class="calibre7">Height</i>, it changes based on selected settings)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre98" src="images/image92.png"/><br class="calibre6"/> </li>
<li class="block_25">In our example the result looks like this, your image will vary<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre99" src="images/image93.png"/></li>
<li class="block_25">The app is now ready!<br class="calibre6"/> </li>
<li class="block_32">At the top right of the designer, click <b class="calibre5">Save</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre65" src="images/image-24.png"/></li>
</ol>
<p class="block_43" id="calibre_pb_6"> </p>
</body>
<body class="calibre">
<p class="block_15" id="id_Toc116995141">Exercise 3: Publish and test your app</p>
<p class="block_">There is a lot more we could so with this app, but we need something functional in a short timeframe, so we will proceed to publish the app. Once the app is published, we will test it within our Team.</p>
<ol class="list_">
<li class="block_16">To begin we will update our apps details, in the ribbon, click <b class="calibre5">Settings</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre100" src="images/image-36.png"/><br class="calibre6"/> </li>
<li class="block_17">On the settings pane, choose a <b class="calibre5">Background color</b> and an <b class="calibre5">Icon</b>, then add the following description: <b class="calibre5">Submit your monthly personal expense claims and view your claims status and history<br class="calibre6"/></b><br class="calibre6"/><img alt="Image" class="calibre101" src="images/image95.png"/></li>
<li class="block_17">Once added click on the <b class="calibre5">&lt;- </b>back arrow at the top left of the <i class="calibre7">Settings</i> page<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre102" src="images/image96.png"/><br class="calibre6"/> </li>
<li class="block_17">Next, in the ribbon, click <b class="calibre5">Publish to Teams</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre103" src="images/image-37.png"/><br class="calibre6"/> </li>
<li class="block_17">Select <b class="calibre5">Next<br class="calibre6"/> </b></li>
<li class="block_17">Click on the <b class="calibre5">+</b> for the <i class="calibre7">Departmental Requests</i> channel<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre104" src="images/image-38.png"/><br class="calibre6"/> </li>
<li class="block_17">Click <b class="calibre5">Save and close</b><br class="calibre6"/> </li>
<li class="block_17">In the left navigation of Microsoft Teams, select <b class="calibre5">Teams</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre19" src="images/image16.png"/><br class="calibre6"/> </li>
<li class="block_17">Select the <b class="calibre5">Departmental Requests</b> channel within your team<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre105" src="images/image99.png"/><br class="calibre6"/> </li>
<li class="block_17">In the channel, select the <b class="calibre5">Expense Claim </b>tab, this may be in the<i class="calibre7"> more</i> drop down<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre106" src="images/image100.png"/><br class="calibre6"/> </li>
<li class="block_17">Choose <b class="calibre5">New Claim</b><br class="calibre6"/> </li>
<li class="block_17">Create a new claim request, then click <b class="calibre5">Save<br class="calibre6"/> </b></li>
<li class="block_17">On the home screen, select <b class="calibre5">Claims List</b>,<b class="calibre5"> </b>then click on your new claim to view it<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre107" src="images/image101.png"/><br class="calibre6"/> </li>
<li class="block_44">Now that we have a means to capture data and store it, we will look at other tools to provide additional on demand information and automated approval for our claims</li>
</ol>
<p class="block_1"> </p>
</body>
<body class="calibre">
<p class="block_7" id="id_Toc116995142">Lab 4 – Create a chatbot</p>
<p class="block_"><img alt="Graphical user interface, application  Description automatically generated" class="calibre15" src="images/image-39.png"/></p>
<p class="block_15" id="id_Toc116995143">Exercise 1: Create a new chatbot</p>
<p class="block_">In this exercise we will begin by creating a new chatbot designed to deal with expense claim related questions. This will be built within our current environment. Creating a new bot can take up to a minute, but do not worry there is an entertaining animation while you wait.</p>
<ol class="list_">
<li class="block_24">In the left navigation in Microsoft Teams, click on the pinned <b class="calibre5">Power Apps</b> app <br class="calibre6"/>(remember to press <b class="calibre5">CTRL </b>+<b class="calibre5"> F5</b> if it is taking a long time to load)<br class="calibre6"/> </li>
<li class="block_25">Select the <b class="calibre5">Build </b>tab<br class="calibre6"/> </li>
<li class="block_25">Ensure your Team is selected in the left navigation<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre108" src="images/image-40.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, click on <b class="calibre5">New</b> and choose <b class="calibre5">Chatbot</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre109" src="images/image-41.png"/><br class="calibre6"/> </li>
<li class="block_25">This will launch the <i class="calibre7">Power Virtual Agents for Teams</i> app <br class="calibre6"/>(if you need to install this app, click <b class="calibre5">Add</b>)<br class="calibre6"/> </li>
<li class="block_25">When <i class="calibre7">Power Virtual Agents for Teams</i> loads, name your bot <b class="calibre5">Claim Chat</b>, and select your language<br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_27">Allow some time for the bot to be set up, this can take up to a minute, once ready, leave the interface open for the next exercise</li>
</ol>
<p class="block_15" id="id_Toc116995144">Exercise 2: Design a topic</p>
<p class="block_">In chatbots, topics are key. They are the conversations that we can script to allow our bot to respond to what people are asking. Our management often get asked common questions about expense claims. We will create a topic to absorb these questions and offer our staff an on-demand service for expense related queries. We will split this exercise up into sections, starting with creating a topic and trigger phrases, adding nodes and testing the outcomes.</p>
<p class="block_">Please note that during this exercise we will create a full line of conversation concerning questions about travel. We also have lines of questions relating to claim issues and payments which we will not fully complete in this exercise due to time constraints. We can complete this bot in an optional exercise at the end of this module.</p>
<p class="block_43" id="calibre_pb_8"> </p>
</body>
<body class="calibre">
<p class="block_37" id="id_Toc116995145">Create a topic and add trigger phrases</p>
<ol class="list_">
<li class="block_24">Begin by closing the <i class="calibre7">Test bot</i> pane by clicking on the <b class="calibre5">X</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre110" src="images/image-42.png"/><br class="calibre6"/> </li>
<li class="block_25">In the navigation bar to the left, select <b class="calibre5">Topics</b> <img alt="Image" class="calibre111" src="images/image106.png"/> (blow the home icon in the image above)<br class="calibre6"/> </li>
<li class="block_25">In the ribbon, click on <b class="calibre5">+ New topic</b><br class="calibre6"/> </li>
<li class="block_25">In the following fields enter:</li>
</ol>
<div class="calibre27">
<div class="block_45">a) Name – <b class="calibre5">Expense Queries</b></div>
<div class="block_45">b) Friendly Name – <b class="calibre5">Questions about expenses</b></div>
<div class="block_45">c) Description – <b class="calibre5">A topic covering general questions relating to personal monthly expense claims</b><br class="calibre6"/> </div>
</div>
<ol class="list_">
<li class="block_25" value="5">Next, we will add a trigger phrase, add<b class="calibre5"> I have a question about claims</b> into the <i class="calibre7">Enter a trigger phrase</i> field and then click <b class="calibre5">Add<br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre112" src="images/image107.png"/><br class="calibre6"/> </li>
<li class="block_25">Repeat step 5 a further seven times until all the phrases listed below have been created<br class="calibre6"/> </li>
</ol>
<div class="calibre27">
<div class="block_45">a) I have a question about accommodation</div>
<div class="block_45">b) Who should I speak to about expense issues?</div>
<div class="block_45">c) What is the maximum I can claim per month?</div>
<div class="block_45">d) What is the status of my claim?</div>
<div class="block_45">e) Claiming for hotels</div>
<div class="block_45">f) Claiming for travel</div>
<div class="block_45">g) Plan to travel<br class="calibre6"/> </div>
</div>
<ol class="list_">
<li class="block_32" value="7">Although we could add more, we will leave it there, click on <b class="calibre5">Save topic</b> in the ribbon</li>
</ol>
<p class="block_37" id="id_Toc116995146">Adding nodes to the authoring canvas </p>
<ol class="list_">
<li class="block_24">Within your topic details page, click on <b class="calibre5">Go to authoring canvas</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre113" src="images/image108.png"/></li>
<li class="block_25">In the <i class="calibre7">Message</i> node beneath the trigger phrases enter: <b class="calibre5">Welcome to Claims Chat </b>and leave a space after the word chat<br class="calibre6"/> </li>
<li class="block_25">Next, click on the <b class="calibre5">{x}</b> icon in the tool bar and choose <b class="calibre5">bot.UserDisplayName</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre114" src="images/image109.png"/><br class="calibre6"/> </li>
<li class="block_25">This will add the name of the staff member using the bot to the message<br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">(+)</b> below the <i class="calibre7">Message</i> node and choose <b class="calibre5">Ask a question</b><br class="calibre6"/> </li>
<li class="block_25">In the first field enter <b class="calibre5">What can we help you with?<br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre115" src="images/image110.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">Now, commonly we expect the first thing we say to a bot to be checked for keywords like ‘hotel’ or ‘issue’ and for the topic to jump to a relevant part of the conversation<br class="calibre6"/><br class="calibre6"/>With the current question node we can add some intelligence to the bot by adding an entity. An entity allows you to define items to pick from and synonyms (alternate words) for the item. When using these items in a choice question, slot filling helps the conversation jump to the relevant nodes, so if I mentioned Payments in my opening statement, we could jump to the section of the bot covering payments.<br class="calibre6"/> </li>
<li class="block_25">Before we go any further click <b class="calibre5">Save</b> at the top right of the authoring canvas, then choose to <b class="calibre5">Save</b> again when notified about the errors which relate to incomplete fields in a node<br class="calibre6"/> </li>
<li class="block_25">In the left navigation bar click on <b class="calibre5">Entities </b><img alt="Image" class="calibre116" src="images/image111.png"/><br class="calibre6"/> </li>
<li class="block_25">In the ribbon click on <b class="calibre5">+ New custom entity</b><br class="calibre6"/> </li>
<li class="block_25">Name the entity <b class="calibre5">Claims Terms </b>and in the description box, add<b class="calibre5"> Terms relating to expense claims</b><br class="calibre6"/> </li>
<li class="block_25">In list items enter the following, clicking <b class="calibre5">Add </b>after each entry:<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_38">Payments</li>
<li class="block_38">Issues</li>
<li class="block_38">Travel</li>
<li class="block_38">Journey</li>
<li class="block_38">Accommodation<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_32" value="13">Notice that each line can have synonyms which can help to resolve this item if people use another word in its place, spend 2 minutes creating synonyms for each of these items, below are some ideas (the more you have the more likely your bot will respond to natural language), use the <b class="calibre5">Add</b> button (or <b class="calibre5">Enter</b> button on your keyboard) to create and <b class="calibre5">Done</b> to apply</li>
</ol>
<table class="table_2">
<tbody class="calibre25"><tr class="calibre26">
<td class="td_29"><p class="block_46">Payments</p></td>
<td class="td_30"><p class="block_46">Issues</p></td>
<td class="td_31"><p class="block_46">Travel</p></td>
<td class="td_32"><p class="block_46">Journey</p></td>
<td class="td_33"><p class="block_46">Accommodation</p></td>
</tr>
<tr class="calibre26">
<td class="td_34"><p class="block_47">Claim</p></td>
<td class="td_35"><p class="block_47">Problem</p></td>
<td class="td_36"><p class="block_47">Event</p></td>
<td class="td_37"><p class="block_47">Trip</p></td>
<td class="td_38"><p class="block_47">Hotel</p></td>
</tr>
<tr class="calibre26">
<td class="td_34"><p class="block_47">Submission</p></td>
<td class="td_35"><p class="block_47">Support</p></td>
<td class="td_36"><p class="block_47">Training</p></td>
<td class="td_37"><p class="block_47">Driving</p></td>
<td class="td_38"><p class="block_47">Inn</p></td>
</tr>
<tr class="calibre26">
<td class="td_34"><p class="block_4"> </p></td>
<td class="td_35"><p class="block_47">Urgent</p></td>
<td class="td_36"><p class="block_4"> </p></td>
<td class="td_37"><p class="block_47">Train</p></td>
<td class="td_38"><p class="block_47">Lodgings</p></td>
</tr>
<tr class="calibre26">
<td class="td_34"><p class="block_4"> </p></td>
<td class="td_35"><p class="block_4"> </p></td>
<td class="td_36"><p class="block_4"> </p></td>
<td class="td_37"><p class="block_47">Plane</p></td>
<td class="td_38"><p class="block_4"> </p></td>
</tr>
<tr class="calibre26">
<td class="td_39"><p class="block_4"> </p></td>
<td class="td_40"><p class="block_4"> </p></td>
<td class="td_41"><p class="block_4"> </p></td>
<td class="td_42"><p class="block_47">Car</p></td>
<td class="td_43"><p class="block_4"> </p></td>
</tr>
</tbody></table>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_25" value="14">At the bottom of the page, click <b class="calibre5">Save</b>, then once saved, click <b class="calibre5">Close</b> (next to save)<br class="calibre6"/> </li>
<li class="block_25">In the navigation bar to the left, select <b class="calibre5">Topics</b> <img alt="Image" class="calibre111" src="images/image106.png"/> <br class="calibre6"/> </li>
<li class="block_25">Move your mouse cursor over the topic named <i class="calibre7">Expense queries</i> and when revealed, click on the <b class="calibre5">Authoring canvas</b> button<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre117" src="images/image-43.png"/></li>
<li class="block_25">In your <i class="calibre7">Question</i> node, select the <b class="calibre5">Multiple choice options</b> from the <i class="calibre7">Identify</i> field<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre118" src="images/image113.png"/><br class="calibre6"/> </li>
<li class="block_25">Scroll down and select <b class="calibre5">Claims Terms</b> <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre119" src="images/image114.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, pick <b class="calibre5">Select options for user</b> <br class="calibre6"/> </li>
<li class="block_25">Select (tick) the following options:<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_38">Payments</li>
<li class="block_38">Issues</li>
<li class="block_38">Travel<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25" value="21">Use the <b class="calibre5">X</b> to close the options menu<br class="calibre6"/> </li>
<li class="block_25">The node creates a variable to store the selected choice, click on the pencil next to <i class="calibre7">Var</i> <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre120" src="images/image-44.png"/></li>
<li class="block_25">Change the name from <i class="calibre7">Var</i> to <b class="calibre5">VarClaimTopic</b> then close the variable pane by clicking on the <b class="calibre5">X</b> <br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">(+)</b> below the <i class="calibre7">Question</i> node and choose <b class="calibre5">Add a condition</b><br class="calibre6"/> </li>
<li class="block_25">Two conditions will be created<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre121" src="images/image116.png"/><br class="calibre6"/> </li>
<li class="block_25">In the first condition on the left, configure it as follows:<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre122" src="images/image117.png"/><br class="calibre6"/> </li>
<li class="block_25">Move your mouse cursor onto the branching lines<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre123" src="images/image-45.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">(+)</b> add node button<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre124" src="images/image-46.png"/><br class="calibre6"/> </li>
<li class="block_25">Select <b class="calibre5">Add a condition<br class="calibre6"/> </b></li>
<li class="block_25">Configure the next condition as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre125" src="images/image120.png"/><br class="calibre6"/> </li>
<li class="block_25">Repeat steps <b class="calibre5">27 to 29</b> to add the final condition and configure it as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre125" src="images/image121.png"/><br class="calibre6"/> </li>
<li class="block_25">The result should look like this (the ‘all other conditions’ option is cropped from the image)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre126" src="images/image122.png"/><br class="calibre6"/> </li>
<li class="block_25">We will complete the functionality of the <i class="calibre7">Travel </i>branch in this lab, completing the whole bot would take more than our allocated time, but do not worry, instructions for completing the Payments and Issues branches are covered in Lab 6 which is optional<br class="calibre6"/> </li>
<li class="block_25">Below the condition where <i class="calibre7">VarClaimTopic is equal to</i> <i class="calibre7">Travel</i> click on <b class="calibre5">(+)</b> add node and choose <b class="calibre5">Ask a question</b><br class="calibre6"/> </li>
<li class="block_25">Configure as follows (note we have used <b class="calibre5">Options for user</b> to select <b class="calibre5">Journey </b>and <b class="calibre5">Accommodation</b> and we have also renamed <i class="calibre7">Var</i> to <b class="calibre5">VarJourneyTopic</b> using the <b class="calibre5">Edit</b> button)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre127" src="images/image-47.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">ellipsis (…)</b> at the top right of the <i class="calibre7">Question</i> node and choose <b class="calibre5">Skip question</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre128" src="images/image124.png"/><br class="calibre6"/> </li>
<li class="block_25">Choose the option <b class="calibre5">Ask every time</b> and choose <b class="calibre5">Done</b><br class="calibre6"/> </li>
<li class="block_25">Below this question. use the <b class="calibre5">(+)</b> add node button to <b class="calibre5">Add a condition</b> then configure the variable as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre129" src="images/image125.png"/><br class="calibre6"/> </li>
<li class="block_25">Position your mouse cursor over the branches above this node to access and use the <b class="calibre5">(+)</b> add node button and add another <b class="calibre5">Add a condition</b> node<br class="calibre6"/> </li>
<li class="block_25">Configure the new condition node as shown below<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre130" src="images/image126.png"/><br class="calibre6"/> </li>
<li class="block_25">To keep things simple, we will use message nodes to provide the essential information and then end the chat, click on the <b class="calibre5">(+)</b> add node button below the condition where <i class="calibre7">VarJourneyTopic is equal to Journey</i> and choose <b class="calibre5">Show a message</b><br class="calibre6"/> </li>
<li class="block_32">Enter the following into the box: </li>
</ol>
<p class="block_48">Claiming for journeys: </p>
<p class="block_48">Car journeys are costed at 45p per mile and are logged as part of your monthly claim</p>
<p class="block_48">Plane journeys are booked via our admin team, inform them where you are flying from, to and when</p>
<p class="block_48">Train journeys are booked by our admin team, inform them on your starting and end locations and the times (we can offer a taxi service to get you to stations)</p>
<p class="block_48">Contact us for help</p>
<p class="block_36">You can copy and paste this text, but you may need to play with the formatting<br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="43">Select the test <b class="calibre5">Contact us</b> and then click on the <b class="calibre5">Link</b> or press <b class="calibre5">CTRL</b> + <b class="calibre5">K</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre131" src="images/image127.png"/><br class="calibre6"/> </li>
<li class="block_25">In the link box enter <a class="text_6" href="mailto:admin@mycompany.com">mailto:admin@mycompany.com</a> and click on the <b class="calibre5">tick</b><br class="calibre6"/> </li>
<li class="block_25">Next, click on the <b class="calibre5">(+)</b> add node button below the condition where <i class="calibre7">VarJourneyTopic is equal to Accommodation</i> and choose <b class="calibre5">Show a message</b><br class="calibre6"/> </li>
<li class="block_25">Enter the following into the box: <b class="calibre5">We have preferential rates with Holiday Inn and Premier Inn while travelling within the UK, please research online your closest hotel and speak to a member of the admin team about your booking including your preferred hotel and dates. For more information on hotels visit </b><a class="text_9" href="https://www.premierinn.com/">https://www.premierinn.com/</a><b class="calibre5"> or </b><a class="text_9" href="https://www.holidayinn.com/">https://www.holidayinn.com/</a><b class="calibre5"> contact us for help<br class="calibre6"/><br class="calibre6"/></b>Feel free to copy and paste this from the manual to save time.<br class="calibre6"/> </li>
<li class="block_25">Select the test <b class="calibre5">Contact us</b> and then click on the <b class="calibre5">Link</b> or press <b class="calibre5">CTRL</b> + <b class="calibre5">K</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre132" src="images/image128.png"/><br class="calibre6"/> </li>
<li class="block_25">In the link box enter <a class="text_6" href="mailto:admin@mycompany.com">mailto:admin@mycompany.com</a> and click on the <b class="calibre5">tick</b><br class="calibre6"/> </li>
<li class="block_25">If you copied and pasted the text, you may wish to select the text in each message box and remove the bold from the text for consistency </li>
</ol>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_25" value="50">Lastly, end every branch that has a <b class="calibre5">(+)</b> add node option with an <b class="calibre5">End with survey</b> node (use the zoom out option at the bottom left of the canvas to help)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre133" src="images/image129.png"/><br class="calibre6"/> </li>
<li class="block_25">The current topic looks like this after added the <i class="calibre7">End with survey</i> nodes<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre134" src="images/image130.png"/><br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Save</b> in the ribbon <br class="calibre6"/> </li>
<li class="block_25">Once saved, click on <b class="calibre5">Test bot</b> (to the left of the <i class="calibre7">Save</i> button)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre135" src="images/image-48.png"/><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">Test bot</i> pane, click onto the field with the value <i class="calibre7">Type your message</i> and then enter <b class="calibre5">I wish to travel</b> and press <b class="calibre5">Enter</b> on your keyboard or click <b class="calibre5">Send</b><br class="calibre6"/> </li>
<li class="block_25">Because ‘travel’ is an item in out entity, the bot can jump to the question that utilises the item called ‘Travel’, with the authoring canvas open, you should see green ticks on all the nodes that have been bypassed thanks to slot filling<br class="calibre6"/> </li>
<li class="block_27">Choose <b class="calibre5">Journey</b> and then <b class="calibre5">Yes</b> in the chat, then rate your bot</li>
</ol>
<p class="block_15" id="id_Toc116995147">Exercise 3: Publish your chatbot</p>
<p class="block_">Further testing on the bot should be considered, perhaps with a few people feeding into which synonyms and trigger phrases could make the bot more linguistically accommodating. Once the testing has been completed, you can publish the bot. Once a bot is published it is available for your team to use as an app.</p>
<p class="block_37" id="id_Toc116995148">Publish the chatbot</p>
<ol class="list_">
<li class="block_24">In the navigation bar click on <b class="calibre5">Publish </b><img alt="Image" class="calibre136" src="images/image132.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">Select <b class="calibre5">Publish</b> and then <b class="calibre5">Publish</b> on the following dialogue box<br class="calibre6"/> </li>
<li class="block_25">Next, click on <b class="calibre5">Share the bot</b><br class="calibre6"/> </li>
<li class="block_25">Before adding the bot to teams we will customise its details, click on <b class="calibre5">Edit details</b><br class="calibre6"/> </li>
<li class="block_25">Choose to change the icon colour or if desired, change the icon replacing it with an image from your computer<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre137" src="images/image133.png"/><br class="calibre6"/> </li>
<li class="block_25">Update the short description to: <b class="calibre5">Ask questions about your personal monthly claims<br class="calibre6"/> </b></li>
<li class="block_25">Update the long description to: <b class="calibre5">Get help with your monthly expense claims. Ask about what you can claim, how much, who to speak to for travel and accommodation and ask about the status of a claim.</b><br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Save</b><br class="calibre6"/> </li>
<li class="block_25">Next click <b class="calibre5">Add to Teams</b><br class="calibre6"/> </li>
<li class="block_32">Once it has been confirmed that the bot is added to Teams, click <b class="calibre5">Close<br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre138" src="images/image134.png"/></li>
</ol>
<p class="block_37" id="id_Toc116995149">Using your chatbot in Teams</p>
<ol class="list_">
<li class="block_24">In the left navigation in Microsoft Teams, click on <b class="calibre5">Apps</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre23" src="images/image21.png"/><br class="calibre6"/> </li>
<li class="block_25">In the categories menu, select <b class="calibre5">Built for [Company name]</b> <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre139" src="images/image135.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on <b class="calibre5">Claim Chat</b>, note that only members, owners, and guests of your Team will see this bot<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre140" src="images/image136.png"/><br class="calibre6"/> </li>
<li class="block_25">Select <b class="calibre5">Add</b><br class="calibre6"/> </li>
<li class="block_25">The bot will appear in your left navigation bar in Teams, and in the <i class="calibre7">Chat</i> area of Teams, you can right click on the <b class="calibre5">Claims Chat</b> icon in the left navigation bar in Teams to <b class="calibre5">Pin</b> this bot<br class="calibre6"/> </li>
<li class="block_25">Ask the bot “I have a question about claims” pressing <b class="calibre5">Enter</b> on your keyboard when ready, or click <b class="calibre5">Send</b><br class="calibre6"/> </li>
<li class="block_25">Select <b class="calibre5">Travel </b>as it is the most complete branch<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre141" src="images/image137.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, select <b class="calibre5">Accommodation</b><br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Yes</b> and then rate your bot by typing in a number from 1 to 5 and pressing <b class="calibre5">Enter</b> on your keyboard or click <b class="calibre5">Send</b> <br class="calibre6"/> </li>
<li class="block_27">Well done, we understand your bot is not complete, but we have covered all the essentials for now, we can optionally pick this bot up and finish it later in Lab 6 which is optional</li>
</ol>
</body>
<body class="calibre">
<p class="block_7" id="id_Toc116995150">Lab 5 – Create a new flow</p>
<p class="block_"><img alt="Graphical user interface, application  Description automatically generated" class="calibre15" src="images/image-49.png"/></p>
<p class="block_15" id="id_Toc116995151">Exercise 1: Create a new flow</p>
<p class="block_">In this exercise our goal is to start an approval process for newly submitted claims. To do this we will be using Power Apps for Teams to add a new flow which can work alongside the tables in our current environment. </p>
<ol class="list_">
<li class="block_24">In your left navigation in Microsoft Teams, select <b class="calibre5">Power Apps</b> <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre35" src="images/image28.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">Build</b> tab<br class="calibre6"/> </li>
<li class="block_25">Ensure your team is selected in the left navigation, then at the bottom of the list choose <b class="calibre5">See all</b><br class="calibre6"/> </li>
<li class="block_25">Next click <b class="calibre5">+ New</b> &gt; <b class="calibre5">Cloud flow</b> &gt; <b class="calibre5">Automated</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre142" src="images/image139.png"/><br class="calibre6"/> </li>
<li class="block_25">Name the flow <b class="calibre5">Claim Approval Process</b><br class="calibre6"/> </li>
<li class="block_25">In the Search all triggers box, search for <b class="calibre5">Dataverse</b><br class="calibre6"/> </li>
<li class="block_25">In the results, select the trigger named <b class="calibre5">When a row is added, modified or deleted</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre143" src="images/image140.png"/><br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_27">The flow designer will open with When a row is added, modified or deleted acting as the trigger for the automated business process</li>
</ol>
<p class="block_15" id="id_Toc116995152">Exercise 2: Set up an approval process for claims</p>
<p class="block_">Now that we have a flow with a trigger, we will configure that trigger to respond to the new claims created within the <i class="calibre7">Claims</i> table. Once the trigger is configured, we will then pass some essential information onto our approvers to allow them to interact with the request. We will prioritise using Teams to send out communications as this is a Microsoft Dataverse for Teams course. Based on the approvers decision we will then inform the requestee about the outcome and then update their claim in the Claims table. To make the exercise easier to follow it has been split into smaller sections.</p>
<p class="block_1"> </p>
<p class="block_43" id="calibre_pb_10"> </p>
</body>
<body class="calibre">
<p class="block_37" id="id_Toc116995153">Connecting to your environments tables</p>
<ol class="list_">
<li class="block_24">Configure the <i class="calibre7">When a row is added, modified or deleted </i>trigger as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre144" src="images/image141.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, click <b class="calibre5">+ New step</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre145" src="images/image142.png"/><br class="calibre6"/> </li>
<li class="block_25">Search for and add the <b class="calibre5">Initialize variable </b>action<br class="calibre6"/> </li>
<li class="block_25">Add three more Initialize Variable actions so that you have 4<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre146" src="images/image143.png"/><br class="calibre6"/> </li>
<li class="block_25">Clicking on the <b class="calibre5">Header</b> of an action will expand and minimise its configuration, using this feature, configure the variable actions as follows<br class="calibre6"/> </li>
</ol>
<div class="calibre27">
<div class="block_45">a) Initialize variable: </div>
</div>
<ol class="list_2">
<li class="block_49">Name: <b class="calibre5">varManagerEmail</b></li>
<li class="block_49">Type: <b class="calibre5">String</b> </li>
<li class="block_49">Value: <i class="calibre7">leave value blank</i><br class="calibre6"/> </li>
</ol>
<div class="calibre27">
<div class="block_45">b) Initialize variable 2: </div>
</div>
<ol class="list_2">
<li class="block_49">Name: <b class="calibre5">varManagerName</b></li>
<li class="block_49">Type: <b class="calibre5">String</b> </li>
<li class="block_49">Value: <i class="calibre7">leave value blank</i><br class="calibre6"/> </li>
</ol>
<div class="calibre27">
<div class="block_45">c) Initialize variable 3: </div>
</div>
<ol class="list_2">
<li class="block_49">Name: <b class="calibre5">varInitiatorEmail</b></li>
<li class="block_49">Type: <b class="calibre5">String</b> </li>
<li class="block_49">Value: <i class="calibre7">leave value blank</i><br class="calibre6"/> </li>
</ol>
<div class="calibre27">
<div class="block_45">d) Initialize variable 4: </div>
</div>
<ol class="list_2">
<li class="block_49">Name: <b class="calibre5">varInitiatorName</b> </li>
<li class="block_49">Type: <b class="calibre5">String</b> </li>
<li class="block_49">Value: <i class="calibre7">leave value blank</i><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25" value="6">Next, below your variables click <b class="calibre5">+ New step</b> add the <b class="calibre5">Update a row </b>action then configure it as follows, using <b class="calibre5">Show advanced options </b>to see all the fields (note that the Dynamic content/Expression pane opens when using some fields like <i class="calibre7">Row ID</i>, when you see a reference like this <img alt="Image" class="calibre147" src="images/image144.png"/> in an actions configuration, it is added from the Dynamic content tab)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre148" src="images/image-50.png"/><br class="calibre6"/> </li>
</ol>
<p class="block_36">Note if your Dynamic content pane appears below your field rather than as a pop-out to the right side, make your web browser window wider<br class="calibre6"/> </p>
<p class="block_36">The action above is changing the status of the claim to Submitted, so that when the record is viewed in our app, we can see that the process has started successfully<br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="7">Next, we need to rectify an issue with table relationships in our workflow<br class="calibre6"/> </li>
</ol>
<p class="block_39">To explain this, we understand our workflow can reference fields from our claim which is a row in a table. Some of those fields in that row of data like <i class="calibre7">Created By</i> and <i class="calibre7">Approver</i> are actually stored in different tables. </p>
<p class="block_21"> </p>
<p class="block_39">The <i class="calibre7">Approver</i> is stored in the <i class="calibre7">Department Approvers</i> table and the <i class="calibre7">Created By</i> value is stored in a table called <i class="calibre7">Users</i>. Although this looks fine on a form, when we reference these values in a flow, we get a Globally Unique ID, rather than the creator or approvers name. In this workflow we will take the GUID and find the persons real name in the relevant table. Once we know their names, we will store their display names and their email addresses in the variables we created earlier.<br class="calibre6"/> </p>
<ol class="list_">
<li class="block_17" value="8">Add a <b class="calibre5">Get a row by ID</b> action below the <i class="calibre7">Update a row </i>action<br class="calibre6"/> </li>
<li class="block_17">Click on the <b class="calibre5">ellipsis (…)</b> at the top-right of the action and choose <b class="calibre5">Rename</b><br class="calibre6"/> </li>
<li class="block_17">Name the action <b class="calibre5">Managers Details</b><br class="calibre6"/> </li>
<li class="block_17">Configure the action as follows (remember to click on the header to expand the action)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre149" src="images/image146.png"/><br class="calibre6"/> </li>
<li class="block_17">After the action named <i class="calibre7">Managers Details</i> add an action called <b class="calibre5">Search for users (V2)</b><br class="calibre6"/> </li>
<li class="block_17">Using the <b class="calibre5">ellipsis (…)</b> and selecting <b class="calibre5">Rename</b>, change the action name to <b class="calibre5">Search for Manager</b><br class="calibre6"/> </li>
<li class="block_17">Configure the action as follows, using the <b class="calibre5">Name</b> property from the Managers Details dynamic content options<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre150" src="images/image147.png"/><br class="calibre6"/> </li>
<li class="block_17">Next click <b class="calibre5">+ New step</b> and add a <b class="calibre5">Set Variable </b>action <br class="calibre6"/> </li>
<li class="block_17">Configure the actions as follows (if a variable is missing, try recreating it)<br class="calibre6"/> </li>
</ol>
<p class="block_50">Set variable: </p>
<ol class="list_2">
<li class="block_49">Name <b class="calibre5">varManagerEmail</b></li>
<li class="block_49">Value <img alt="Image" class="calibre151" src="images/image148.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_17" value="17">Once this action is configured, it will be placed in an <i class="calibre7">Apply to each</i> action which happens when we are dealing with an array (variable containing multiple values)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre152" src="images/image149.png"/><br class="calibre6"/> </li>
<li class="block_17">Next, in the <i class="calibre7">Apply to each</i> action, click on <b class="calibre5">Add an action</b> and choose another <b class="calibre5">Set variable</b> and configure it as follows<br class="calibre6"/> </li>
</ol>
<p class="block_50">Set variable 2: </p>
<ol class="list_2">
<li class="block_49">Name <b class="calibre5">varManagerName</b> </li>
<li class="block_49">Value <img alt="Image" class="calibre153" src="images/image150.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_17" value="19">Check that you have two set variable actions in your <i class="calibre7">Apply to each</i> action<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre154" src="images/image151.png"/><br class="calibre6"/> </li>
<li class="block_17">Below the Set Variable 2 action within <i class="calibre7">Apply to each</i>, add the action <b class="calibre5">Get a row by ID</b>, we will use this to swap the ID of the claim creator for their real name, which is stored in the Users table<br class="calibre6"/> </li>
<li class="block_17">Using the <b class="calibre5">ellipsis (…)</b> click <b class="calibre5">Rename</b> and update the action name to <b class="calibre5">Initiators Details</b><br class="calibre6"/> </li>
<li class="block_17">Configure the action as follows, note there are now duplicated properties in the dynamic contents menu from actions in the workflow, we want the <b class="calibre5">Created By (Value)</b> property from the category <i class="calibre7">Update a row </i><span class="text_10">do not use the value from the </span><span class="text_11">Managers Details</span><span class="text_10"> category, this will be the wrong person</span><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre155" src="images/image-51.png"/></li>
<li class="block_17">Using the <b class="calibre5">Add an action</b> button add two <b class="calibre5">Set Variable</b> actions, within <i class="calibre7">Apply to each</i><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre156" src="images/image153.png"/><br class="calibre6"/> </li>
<li class="block_17">Configure the actions as follows (if a variable is missing, try recreating it)<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_49">Set variable 3: </li>
</ol>
<ol class="list_2">
<li class="block_51">Name <b class="calibre5">varInitiatorEmail</b></li>
<li class="block_51">Value <img alt="Image" class="calibre157" src="images/image154.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_49" value="2">Set variable 4: </li>
</ol>
<ol class="list_2">
<li class="block_51">Name <b class="calibre5">varInitiatorName</b> </li>
<li class="block_51">Value <img alt="Image" class="calibre158" src="images/image155.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_44" value="25">Our variables are now populated with essential information about the manager and the initiator of the process who created the claim, we can now look at the approval process, click <b class="calibre5">Save</b></li>
</ol>
<p class="block_37" id="id_Toc116995154">Setting up the approval process</p>
<ol class="list_">
<li class="block_24">Within the <i class="calibre7">Apply to each</i> action, below <i class="calibre7">Set Variable 4</i> click <b class="calibre5">Add an action</b> and choose <b class="calibre5">Post a choice of options as the Flow bot to a user</b> which is a Teams action<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25">Configure the action as follows, using the <b class="calibre5">Add new item</b> button to add a row for Options Item - 2<br class="calibre6"/><br class="calibre6"/><img alt="Graphical user interface, text, application, email  Description automatically generated" class="calibre159" src="images/image-52.png"/><br class="calibre6"/><br class="calibre6"/>Note that the values in the image above are truncated, the full values are <i class="calibre7">Recipient</i> <b class="calibre5">varManagerEmail</b>, <i class="calibre7">Message</i> <b class="calibre5">varInitiatorName</b>, <b class="calibre5">Claim description</b>, <b class="calibre5">Cost</b> and <b class="calibre5">ClaimID</b>, the rest is added as typed static text. Note that these properties exist in more than one category in <i class="calibre7">Dynamic content</i> but they are the same value.<br class="calibre6"/> </li>
<li class="block_25">Below the action <i class="calibre7">Post a choice of options as the Flow bot to a user</i>, within the <i class="calibre7">Apply to each</i> container click <b class="calibre5">Add an action</b> and choose a <b class="calibre5">Condition</b> action<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre160" src="images/image157.png"/><br class="calibre6"/> </li>
<li class="block_25">Configure the action as follows using the dynamic content <b class="calibre5">selectedOption</b> as the first value and manually type in <b class="calibre5">Approve Claim</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre161" src="images/image158.png"/><br class="calibre6"/> </li>
<li class="block_32">We now have a branching outcome for the approver’s decision</li>
</ol>
<p class="block_37" id="id_Toc116995155">Updating the claim in the table</p>
<ol class="list_">
<li class="block_24">In the <i class="calibre7">If Yes</i><span class="text_12"> </span>(<span class="text_13">green</span>) branch of the condition click the <b class="calibre5">Add an action</b> button to add an <b class="calibre5">Update a row</b> action and configure it as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre162" src="images/image-53.png"/><br class="calibre6"/><br class="calibre6"/>Note that the property <b class="calibre5">Claims</b> exists in more than one category in <i class="calibre7">Dynamic content</i>, but they are both the same value<br class="calibre6"/> </li>
<li class="block_25">Now that the claim is set to approved for the <i class="calibre7">If Yes</i> branch, add another <b class="calibre5">Update a row</b> action, but this time add it to the <i class="calibre7">Is No</i> (<span class="text_14">red</span>) branch and configure it as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre163" src="images/image-54.png"/><br class="calibre6"/> </li>
<li class="block_32">Now the claim records will be updated with the approver’s decision, next we will communicate the decision to the person submitting the claim (the initiator), click <b class="calibre5">Save</b></li>
</ol>
<p class="block_37" id="id_Toc116995156">Sending a response to the requestee</p>
<ol class="list_">
<li class="block_24">In the <i class="calibre7">Is Yes</i> (<span class="text_13">green</span>) branch, use the <b class="calibre5">Add an action</b> button to add a <b class="calibre5">Post a message in a chat or channel</b> which is a Teams action and configure it as follows<br class="calibre6"/><br class="calibre6"/><img alt="Graphical user interface, text, application, email  Description automatically generated" class="calibre164" src="images/image-55.png"/><br class="calibre6"/> </li>
<li class="block_27">Next repeat the process for the <i class="calibre7">Is No</i> (<span class="text_14">red</span>) branch (do not use the copy to my clipboard option as this can cause issues)<br class="calibre6"/><br class="calibre6"/><img alt="Graphical user interface, text, application, email  Description automatically generated" class="calibre165" src="images/image-56.png"/><br class="calibre6"/><br class="calibre6"/><br class="calibre166" id="calibre_pb_11"/>
</li>
</ol>
</body>
<body class="calibre">
<ol class="list_">
<li class="block_27">
</li>
</ol>
<p class="block_15" id="id_Toc116995157">Exercise 3: Publish and test the flow</p>
<p class="block_">Now that the flow is configured, we will want to publish it, which is simply done by saving the flow. To test it we will need to trigger the flow, which is done by adding a new claim using our app.</p>
<ol class="list_">
<li class="block_24">At the top right of the designer, click on <b class="calibre5">Save</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre167" src="images/image-57.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25">Once saved, in the left navigation of Microsoft Teams, click on the <b class="calibre5">Teams</b> button<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre168" src="images/image164.png"/><br class="calibre6"/> </li>
<li class="block_25">Within your team, select the <b class="calibre5">Departmental Requests</b> channel<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre169" src="images/image165.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, choose the <b class="calibre5">Expense Claim </b>tab, this may be in the <i class="calibre7">More</i> drop down menu<br class="calibre6"/> </li>
<li class="block_25">In your app, click <b class="calibre5">New Claim</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre170" src="images/image166.png"/><br class="calibre6"/> </li>
<li class="block_25">Create a new claim, please choose <b class="calibre5">Yourself</b> as the approver<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre171" src="images/image167.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, click <b class="calibre5">Save</b> at the top-right of the claims app<br class="calibre6"/> </li>
<li class="block_25">In the left navigation of Microsoft Teams, click on <b class="calibre5">Chat</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre172" src="images/image168.png"/><br class="calibre6"/> </li>
<li class="block_25">You may need to wait a couple of minutes for the flow to start, be patient, you should eventually receive a chat message from <i class="calibre7">Flow</i> (if you do not, view step 12)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre173" src="images/image169.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the <b class="calibre5">Flow</b> chat and choose to <b class="calibre5">Approve Claim</b> or <b class="calibre5">Reject Claim</b> and add some <i class="calibre7">Comments</i> before clicking <b class="calibre5">Submit</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre174" src="images/image170.png"/><br class="calibre6"/> </li>
<li class="block_25">You should receive the response as you are both the initiator and the approver<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre175" src="images/image171.png"/><br class="calibre6"/> </li>
<li class="block_25">Your workflow is working successfully, and you have completed this exercise<br class="calibre6"/> </li>
</ol>
<p class="block_36">However, if you did not receive some or any of your chat messages from flow, there could be an issue, we can work out the problem from the workflow history, to get there click on </p>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_38"><b class="calibre5">Power Apps</b> in the Teams navigation bar<br class="calibre6"/> </li>
<li class="block_38">Click on the <b class="calibre5">Build</b> tab<br class="calibre6"/> </li>
<li class="block_38">Select your Team in the left menu and then click <b class="calibre5">See all</b> then <b class="calibre5">Cloud flows</b><br class="calibre6"/> </li>
<li class="block_38">In the item menu click on the <b class="calibre5">Claim Approval Process </b>workflow<br class="calibre6"/> </li>
<li class="block_38">Scroll down to view the history, if the flow is still running it may continue, it will just need time, if there is an error, click on the <b class="calibre5">Date/Time</b> stamp<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre176" src="images/image-58.png"/><br class="calibre6"/> </li>
<li class="block_38">Expand the actions to identify the root cause and use the suggestions pane on the right to gather ideas to resolve the issue, click <b class="calibre5">Edit</b> at the top-right of the page and cross-check the failing action with the configuration in Exercise 2<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre177" src="images/image173.png"/><br class="calibre6"/> </li>
<li class="block_52">In the example above there was not actually an issue with the workflow, because we can leave the approver blank when submitting a new claim in our app, the workflow failed due to the property being blank (we could resolve this by making the approver field mandatory)</li>
</ol>
</body>
<body class="calibre">
<p class="block_7" id="id_Toc116995158">Lab 6 – Connect a chatbot to a table using a flow</p>
<p class="block_"><img alt="Graphical user interface, text, application  Description automatically generated" class="calibre15" src="images/image-59.png"/></p>
<p class="block_15" id="id_Toc116995159">Exercise 1: Design a new flow to access a table</p>
<p class="block_">Before we update our chatbot, we will need a workflow for it to call that is designed to take the Claim ID from a user in our chatbot and query the claim records for a match and retrieve the status of the claim. Once ready, we will save the flow.</p>
<ol class="list_">
<li class="block_24">In your left navigation in Microsoft Teams, select <b class="calibre5">Power Apps</b> <br class="calibre6"/>(press <b class="calibre5">CRTL</b> + <b class="calibre5">F5 </b>to refresh the page if it gets stuck loading)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre35" src="images/image28.png"/><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">Build</b> tab<br class="calibre6"/> </li>
<li class="block_25">Ensure your team is selected in the left navigation, then at the bottom of the list choose <b class="calibre5">See all</b><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">Claims</b> table<br class="calibre6"/> </li>
<li class="block_25">For the <i class="calibre7">ClaimID</i> column, make a note of the column <i class="calibre7">Name</i>, in the following image, the column name we need to document is <b class="calibre5">cr388_claimid</b> <span class="text_10">yours will be different</span><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre178" src="images/image-60.png"/><br class="calibre6"/> </li>
<li class="block_25">Once you have documented the columns name, click on <b class="calibre5">Cloud flows</b> in the left navigation<br class="calibre6"/> </li>
<li class="block_25">Next click <b class="calibre5">+ New</b> &gt; <b class="calibre5">Cloud flow</b> &gt; <b class="calibre5">Instant<br class="calibre6"/><br class="calibre6"/></b><img alt="Image" class="calibre179" src="images/image176.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">Name the flow <b class="calibre5">Retrieve Claim Status<br class="calibre6"/> </b></li>
<li class="block_25">Select the trigger named <b class="calibre5">When Power Virtual Agents calls a flow</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre180" src="images/image177.png"/><br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Create</b><br class="calibre6"/> </li>
<li class="block_25">The flow designer will open with <i class="calibre7">Power Virtual Agents</i> acting as the trigger for the instant business process, click on the triggers <b class="calibre5">heading </b>to expand it and choose <b class="calibre5">+ Add an input</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre181" src="images/image178.png"/><br class="calibre6"/> </li>
<li class="block_25">Choose the option <b class="calibre5">Number</b><br class="calibre6"/> </li>
<li class="block_25">Rename the input from <i class="calibre7">Number</i> to <b class="calibre5">varBotClaimID</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre182" src="images/image179.png"/><br class="calibre6"/> </li>
<li class="block_25">Below the trigger, click on <b class="calibre5">+ New step</b><br class="calibre6"/> </li>
<li class="block_25">Add the action <b class="calibre5">Initialize variable</b><br class="calibre6"/> </li>
<li class="block_25">Configure the action as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre183" src="images/image180.png"/><br class="calibre6"/> </li>
<li class="block_25">Below this variable add another <b class="calibre5">Initialize variable</b> action and configure it as follows<br class="calibre6"/> </li>
</ol>
<p class="block_36"><img alt="Image" class="calibre183" src="images/image181.png"/><br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="18">Below the variables, click on <b class="calibre5">+ New step</b><br class="calibre6"/> </li>
<li class="block_25">Add the action <b class="calibre5">List rows</b><br class="calibre6"/> </li>
<li class="block_25">Configure the action as follows using your <span class="text_10">documented column name </span>from step 5<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre184" src="images/image-61.png"/><br class="calibre6"/><span class="text_10"><br class="calibre6"/>Please be aware of the single quotes at the start of CLAIM and at the end of the dynamic reference<br class="calibre6"/> </span></li>
<li class="block_25">Next click <b class="calibre5">+ New step</b> and add the action named <b class="calibre5">Set variable</b> and configure it as follows<br class="calibre6"/> </li>
</ol>
<p class="block_36"><img alt="Image" class="calibre185" src="images/image183.png"/><br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="22">You flow will add an <i class="calibre7">Apply to each</i> control to work with the array named <i class="calibre7">value</i><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre186" src="images/image184.png"/><br class="calibre6"/> </li>
</ol>
<p class="block_39">A little issue to overcome is that the claim status is picked up as a numerical value, in the following example you can see that <i class="calibre7">Approve </i>is the value 1, <i class="calibre7">Reject </i>is 2 and <i class="calibre7">Submitted</i> is 0, to correct this we can use an expression<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre187" src="images/image185.png"/><br class="calibre6"/> </p>
<ol class="list_">
<li class="block_25" value="23">Within the <i class="calibre7">Apply to each </i>action, after <i class="calibre7">Set variable</i>, add a second <b class="calibre5">Set variable</b> action<br class="calibre6"/> </li>
<li class="block_25">Configure the Name as <b class="calibre5">varClaimStatus</b><br class="calibre6"/> </li>
<li class="block_25">Click into the <b class="calibre5">Value</b> field, select <b class="calibre5">Expression</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre188" src="images/image-62.png"/></li>
<li class="block_25">In the <i class="calibre7">fx</i> field enter <b class="calibre5">replace(replace(replace(variables('varClaimStatusNumber'),'0','Submitted'),'1','Approved'),'2','Declined')<br class="calibre6"/><br class="calibre6"/></b><span class="text_10">You can copy and paste this to save time<br class="calibre6"/> </span></li>
<li class="block_25">Once ready, click <b class="calibre5">OK</b> and the results should look like this<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre189" src="images/image187.png"/><br class="calibre6"/><br class="calibre6"/>This formula simply replaces values 0, 1 and 2 with Submitted, Approved and Declined, you could also use a switch action to do this, but it would require another 4 actions<b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">Next at the bottom of the flow, below the <i class="calibre7">Apply to each</i> action, click <b class="calibre5">+ New step</b> and add <b class="calibre5">Return value(s) to Power Virtual Agents</b><br class="calibre6"/> </li>
<li class="block_25">Select <b class="calibre5">+ Add an output</b> and choose <b class="calibre5">Text</b><br class="calibre6"/> </li>
<li class="block_25">Configure the text output as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre190" src="images/image188.png"/><br class="calibre6"/> </li>
<li class="block_25">This will pass the updated status of the claim (not the number) to the bot<br class="calibre6"/> </li>
<li class="block_27">At the top-right of the flow, click <b class="calibre5">Save</b><br class="calibre6"/> </li>
</ol>
<p class="block_15" id="id_Toc116995160">Exercise 2: Update topic and add your flow</p>
<p class="block_">Now that we have a flow that will retrieve the status of our claim, we can now build it into our chatbot named <i class="calibre7">Claims Chat</i>. We will do this by updating our existing topic with a call an action node to trigger our new flow. To begin we need the Claim ID of a claim.</p>
<ol class="list_">
<li class="block_24">Click on the <b class="calibre5">Chat</b> tab in the Microsoft Teams left navigation bar<br class="calibre6"/> </li>
<li class="block_25">Next, click on the <b class="calibre5">Flow</b> chat<br class="calibre6"/> </li>
<li class="block_25">In the chat history, locate the Claim ID number of your test, in the example below it would be 0001004, yours may be different (keep this information for later)<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre191" src="images/image189.png"/><br class="calibre6"/> </li>
<li class="block_25">Next in the Microsoft Teams left navigation bar select <b class="calibre5">Power Apps</b> <br class="calibre6"/>(remember you can press <b class="calibre5">CTRL</b> + <b class="calibre5">F5</b> to refresh the page if it gets stuck loading)<br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">Build </b>tab<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre192" src="images/image-63.png"/><br class="calibre6"/> </li>
<li class="block_25">Ensure your team is selected in the left navigation, take a moment to marvel at all the things you created in this course, then click on <b class="calibre5">Claim Chat </b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre193" src="images/image191.png"/><br class="calibre6"/> </li>
<li class="block_25">When <i class="calibre7">Power Virtual Agents for Teams</i> loads select <b class="calibre5">Topics</b> <img alt="Image" class="calibre194" src="images/image192.png"/> from the left navigation<br class="calibre6"/> </li>
<li class="block_25">Position your mouse cursor over the <i class="calibre7">Expense Queries</i> topic and click on the <b class="calibre5">Authoring canvas </b><img alt="Image" class="calibre195" src="images/image193.png"/><b class="calibre5"> </b>button<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre196" src="images/image-64.png"/><br class="calibre6"/> </li>
<li class="block_25">Locate the conditional node where <i class="calibre7">varClaimTopic is equal to Payments</i><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre197" src="images/image195.png"/><br class="calibre6"/> </li>
<li class="block_25">Move your mouse cursor over the branch between this action and the <i class="calibre7">End</i> node below to reveal the <b class="calibre5">Add node</b> button<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre198" src="images/image196.png"/><br class="calibre6"/> </li>
<li class="block_25">Choose <b class="calibre5">Ask a question</b> and then in the <i class="calibre7">Ask a question box</i> enter <b class="calibre5">Which area of payments are you interested in?</b><br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">Identify</i> field, leave <i class="calibre7">Multiple choice options</i> selected and in options for user enter the following, using <b class="calibre5">+ New option</b> to add more values<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_38">Who to contact about a claim?</li>
<li class="block_38">What is the status of my claim?</li>
<li class="block_38">What is the maximum claim amount?<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre199" src="images/image197.png"/><br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25" value="13">Click on the <b class="calibre5">Edit</b> icon next to <i class="calibre7">Var</i> and the bottom of this node and update the name to VarPaymentsTopic<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre200" src="images/image198.png"/><br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">X</b> to close the edit variable pane<br class="calibre6"/> </li>
<li class="block_25">Because we manually created our choices for this question, our topic has generated the conditions for our choices <br class="calibre6"/> </li>
<li class="block_25">Locate the condition where <i class="calibre7">VarPaymentsTopic is equal to What is the status of my claim? </i><br class="calibre6"/> </li>
<li class="block_25">Then select <b class="calibre5">(+)</b> add node below this node and choose <b class="calibre5">Ask a question</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre201" src="images/image-65.png"/><br class="calibre6"/> </li>
<li class="block_25">Configure the <i class="calibre7">Question</i> node as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre202" src="images/image200.png"/><br class="calibre6"/> </li>
<li class="block_25">Next, add a new <b class="calibre5">Call an action</b> node below your question, choosing the flow called <b class="calibre5">Retrieve Claim Status</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre203" src="images/image-66.png"/><br class="calibre6"/> </li>
<li class="block_25">Configure the <i class="calibre7">Action</i> as follows<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre204" src="images/image202.png"/><br class="calibre6"/> </li>
<li class="block_25">Add another node below the <i class="calibre7">Action</i> node and choose <b class="calibre5">Show a message</b> and configure this node as follows, using the <b class="calibre5">{x]</b> button to add variables<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre205" src="images/image203.png"/><br class="calibre6"/> </li>
<li class="block_25">Lastly, add an <b class="calibre5">End with survey</b> node below the <i class="calibre7">Message</i> node<br class="calibre6"/> </li>
<li class="block_25">Click <b class="calibre5">Save<br class="calibre6"/> </b></li>
<li class="block_25">Next to the save button click <b class="calibre5">Test bot </b>to open the test pane if it is not already open<br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">Test bot</i> pane, enter the following into the chat <b class="calibre5">What is the status of my claim?</b><br class="calibre6"/> </li>
<li class="block_25">Thanks to slot filling, we can skip to straight to the question asking about the ID number<b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">Add your Claim ID number from step 3, e.g. <i class="calibre7">00001001</i> or <i class="calibre7">00001004</i><br class="calibre6"/> </li>
<li class="block_32">Your results will vary based on whether you chose to approve or decline the claim</li>
</ol>
<table class="table_4">
<tbody class="calibre25"><tr class="calibre26">
<td class="td_6"><p class="block_30"><img alt="Image" class="calibre206" src="images/image204.png"/></p></td>
<td class="td_7"><p class="block_30">Note that if your status comes back blank, this is likely due to a mismatch between the filter in the <i class="calibre207">List rows</i> action and the way the ClaimID is referenced in the table. You can <b class="calibre28">Save</b> your bot then navigate to the <b class="calibre28">Claims</b> table and choose <b class="calibre28">Edit data</b> and review the structure of a claim ID e.g. <br class="calibre29"/><span class="text_15">CLAIM-0000</span><i class="calibre207">1001 </i>then edit the formula in the <i class="calibre207">List rows </i>action in the flow to match e.g. <br class="calibre29"/><i class="calibre207">cr388</i>_claimid eq ‘<span class="text_16">CLAIM-0000</span>[var]’</p></td>
</tr>
</tbody></table>
<p class="block_28"> </p>
<ol class="list_">
<li class="block_27" value="29">We will now look at completing the other outcomes for the <i class="calibre7">Claims Chat</i> bot</li>
</ol>
<p class="block_15" id="id_Toc116995161">Exercise 3: Complete the remaining topic nodes</p>
<p class="block_">In our chatbot we have completed questions about travel and payment questions related to a claim’s status. There are three branches that are missing information. In this exercise we will complete these branches with some simple information to finish the conversations correctly. Below is the diagram of the chatbot as it currently stands, the testing path for the previous exercise is highlighted in green. Marked with red warnings are the areas of conversation that have no information. We will start with the top branch relating to issues and finish the two branches in payments at the bottom.</p>
<p class="block_"><img alt="Image" class="calibre208" src="images/image205.png"/></p>
<p class="block_43" id="calibre_pb_13"> </p>
</body>
<body class="calibre">
<ol class="list_">
<li class="block_24">Below the first question node with the entry <i class="calibre7">What can we help you with?</i> Look for the condition node where <i class="calibre7">VarClaimTopic is equal to Issues<br class="calibre6"/> </i></li>
<li class="block_25">Between this node and the <i class="calibre7">End</i> node, place your mouse cursor on the branch to reveal the <b class="calibre5">(+)</b> add node button and click it, then add a <b class="calibre5">Show a message</b> node<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre209" src="images/image206.png"/><br class="calibre6"/> </li>
<li class="block_25">In the message node enter <b class="calibre5">We are sorry to hear you are having issues with your personal expense claims, this would probably be better discussed with our admin team. Please click here to send them an email describing your issue and any other information you can provide.<br class="calibre6"/><br class="calibre6"/></b>Feel free to copy and paste this text, and remove the bold font<br class="calibre6"/> </li>
<li class="block_25">In the <i class="calibre7">message</i> node highlight <b class="calibre5">click here</b> with your mouse and then click on <b class="calibre5">Link</b> or press <b class="calibre5">CTRL </b>+ <b class="calibre5">K</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre210" src="images/image-67.png"/><br class="calibre6"/> </li>
<li class="block_25">Enter <b class="calibre5">mailto:admin@mycompany.com</b> into the field and then click on the <b class="calibre5">tick</b><br class="calibre6"/> </li>
<li class="block_25">Below the question node with the entry <i class="calibre7">What area of payments are you interested in?</i> Look for the condition node where <i class="calibre7">VarPaymentsTopic is equal to Who to contact about a claim?</i><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">(+)</b> add node button below the node and add a <b class="calibre5">Show a message</b> node<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre211" src="images/image208.png"/><br class="calibre6"/> </li>
<li class="block_25">In the message node enter <b class="calibre5">Your claims are approved by the line manager you specify when you complete a claim request. If you would like to speak to check which approver is assigned to your claim, you can take a look at the Expense Claims app in the Department Requests channel.</b><br class="calibre6"/><br class="calibre6"/>Again feel free to copy and paste this into the node, removing the bold font after<br class="calibre6"/> </li>
<li class="block_25">Under this node, click on the <b class="calibre5">(+)</b> add node button and select <b class="calibre5">End with survey</b><br class="calibre6"/> </li>
<li class="block_25">Below the question node with the entry <i class="calibre7">What area of payments are you interested in?</i> Look for the condition node where <i class="calibre7">VarPaymentsTopic is equal to What is the maximum claim amount?</i><br class="calibre6"/> </li>
<li class="block_25">Click on the <b class="calibre5">(+)</b> add node button below the node and add a <b class="calibre5">Show a message</b> node<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre212" src="images/image-68.png"/><br class="calibre6"/> </li>
<li class="block_25">In the message node enter <b class="calibre5">The maximum you can claim per month is £2,000</b> you can copy and paste this into the node, remembering to remove the bold font after<br class="calibre6"/> </li>
<li class="block_25">Under this node, click on the <b class="calibre5">(+)</b> add node button and select <b class="calibre5">End with survey<br class="calibre6"/> </b></li>
<li class="block_32">The finished chatbot looks like this<br class="calibre6"/> </li>
</ol>
<p class="block_"><img alt="Image" class="calibre213" src="images/image210.png"/></p>
<p class="block_43" id="calibre_pb_14"> </p>
</body>
<body class="calibre">
<p class="block_15" id="id_Toc116995162">Exercise 4: Test your enhanced bot and publish</p>
<p class="block_">We will now save and test the new chatbot, and then finish this exercise by publishing the latest changes.</p>
<ol class="list_">
<li class="block_24">In the ribbon click on <b class="calibre5">Save</b><br class="calibre6"/> </li>
<li class="block_25">Then click <b class="calibre5">Test bot</b> to open the panel if it is not already open<br class="calibre6"/> </li>
<li class="block_25">Here are some phrases to try out (use <b class="calibre5">Reset</b> to restart)<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_38">I’m planning on travelling &gt; Travel &gt; Accommodation<br class="calibre6"/> </li>
<li class="block_38">What is the maximum I can claim? &gt; Payments &gt; What is the maximum claim amount?<br class="calibre6"/> </li>
</ol>
<ol class="list_">
<li class="block_25" value="4">To improve the bot, we may need more trigger phrases, more entity items with synonyms and more outcomes as nodes in the topic and maybe further topics<br class="calibre6"/> </li>
<li class="block_25">In the navigation bar click on <b class="calibre5">Publish </b><img alt="Image" class="calibre136" src="images/image132.png"/><b class="calibre5"><br class="calibre6"/> </b></li>
<li class="block_25">Select <b class="calibre5">Publish</b> and then <b class="calibre5">Publish</b> once more on the following dialogue box<br class="calibre6"/> </li>
<li class="block_25">Now that the bot has been republished, click on <b class="calibre5">Teams</b> in the left navigation of Microsoft Teams to exit <i class="calibre7">Power Virtual Agents for Teams</i>, your colleagues experience for submitting data using forms, receiving real time information has been revolutionised by Microsoft Dataverse for Teams</li>
</ol>
<p class="block_53"> </p>
<p class="block_53"> </p>
<table class="table_4">
<tbody class="calibre25"><tr class="calibre26">
<td class="td_44"><p class="block_54"><img alt="Image" class="calibre214" src="images/image211.png"/></p></td>
<td class="td_45"><p class="block_54"><img alt="Image" class="calibre215" src="images/image212.png"/></p></td>
<td class="td_46"><p class="block_54"><img alt="Image" class="calibre216" src="images/image213.png"/></p></td>
</tr>
</tbody></table>
<p class="block_1"> </p>
<p class="block_15" id="id_Toc116995163">Exercise 5: Exploring Power BI Desktop</p>
<p class="block_">As part of your Microsoft Dataverse for Teams experience, you manager has asked if it is possible to report on the data that is being added to our tables. You inform them that you can connect to tables using a desktop application called Power BI Desktop. Your organisation does not presently have any licenses for Power BI online, so you have been asked to explore the potential of this tool before the business invests in buying licenses.</p>
<p class="block_">In this exercise your goal is to download and install Power BI Desktop and create a report that is based on a sample dataset provided by Microsoft. Please note that if you are not allowed to install applications on your current device, you can complete this exercise on a personal computer, rather than a business device.</p>
<ol class="list_">
<li class="block_24">Navigate to: <a class="text_6" href="https://www.microsoft.com/en-us/download/details.aspx?id=58494">https://www.microsoft.com/en-us/download/details.aspx?id=58494</a> <br class="calibre6"/> </li>
<li class="block_25">Select your language and then choose <b class="calibre5">Download</b><br class="calibre6"/> </li>
<li class="block_25">Select the version of the product to download, x64 is the 64bit version of the product<br class="calibre6"/> </li>
<li class="block_25">Then choose <b class="calibre5">Next</b><br class="calibre6"/> </li>
<li class="block_25">The application will then download<br class="calibre6"/> </li>
<li class="block_25">Once downloaded, please locate the downloaded file, double click on it, and run the install wizard<br class="calibre6"/> </li>
<li class="block_25">Once installed, open the application (to find it press the <b class="calibre5">Start</b> key on your keyboard and type in <i class="calibre7">Power BI</i> and then select <b class="calibre5">Power BI Desktop</b>)<br class="calibre6"/> </li>
<li class="block_25">When Power BI Desktop opens, close the welcome dialog by clicking <b class="calibre5">X</b> <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre217" src="images/image-69.png"/><br class="calibre6"/> </li>
<li class="block_25">To add the sample dataset, click on the <b class="calibre5">Try a sample dataset</b> option in the middle of the page<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre218" src="images/image215.png"/><br class="calibre6"/> </li>
<li class="block_25">On the pop up, select <b class="calibre5">Load sample data</b><br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre219" src="images/image216.png"/><br class="calibre6"/> </li>
<li class="block_25">Select the <b class="calibre5">financials</b> table <br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre220" src="images/image217.png"/></li>
<li class="block_25">Next click <b class="calibre5">Load</b><br class="calibre6"/> </li>
<li class="block_25">A selection of columns will appear in the <i class="calibre7">Fields</i> pane, at this point you are free to use the <i class="calibre7">Visualizations</i> pane to add visuals to your report page<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre221" src="images/image-70.png"/></li>
<li class="block_25">Once a visualisation has been added, you can click on it, selecting a visualisation will update the <i class="calibre7">Visualizations</i> pane with the configuration for the visual, allowing you to drag and drop columns from the <i class="calibre7">Fields</i> pane into the wells in the visual’s configuration<br class="calibre6"/><br class="calibre6"/><img alt="Image" class="calibre222" src="images/image219.png"/><br class="calibre6"/> </li>
<li class="block_25">Experiment with a mixture of properties in different visualisation types, not everything will work together but explore to see what you can create, moving and resizing the visuals when needed</li>
</ol>
<p class="block_53"> </p>
<p class="block_55"><img alt="Image" class="calibre223" src="images/image220.png"/></p>
<p class="block_53"> </p>
<p class="block_39">If you would like to save your work, click on the <b class="calibre5">Save</b> button at the top left of Power BI Desktop above the ribbon, name your project file and choose where to save it before clicking <b class="calibre5">Save</b> once more<br class="calibre6"/> </p>
<p class="block_">For additional learning click on the <b class="calibre5">Help </b>tab in the ribbon and choose a way to learn</p>
</body>
